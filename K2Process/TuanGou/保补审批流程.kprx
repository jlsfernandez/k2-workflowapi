<?xml version="1.0" encoding="utf-8"?><Process Type="SourceCode.Workflow.Design.DefaultProcess" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" Version="4"><References><AssemblyReference><Guid>8ec28f3f09a343258148e3747f1dd98a</Guid><ItemName>Reference</ItemName><ItemInclude>System</ItemInclude><AssemblyName>System</AssemblyName></AssemblyReference><AssemblyReference><Guid>e32f18615e4e4921a688c3e1107bface</Guid><ItemName>Reference</ItemName><ItemInclude>System.Drawing</ItemInclude><AssemblyName>System.Drawing</AssemblyName></AssemblyReference><AssemblyReference><Guid>b9e1e594a9b744fb815fcc0029078912</Guid><ItemName>Reference</ItemName><ItemInclude>System.Windows.Forms</ItemInclude><AssemblyName>System.Windows.Forms</AssemblyName></AssemblyReference><AssemblyReference><Guid>3d4cd4bd96604b75b38a4023a97ec76f</Guid><ItemName>Reference</ItemName><ItemInclude>System.Data</ItemInclude><AssemblyName>System.Data</AssemblyName></AssemblyReference><AssemblyReference><Guid>04b09a9cafec40ffbb39051bd04fcf77</Guid><ItemName>Reference</ItemName><ItemInclude>System.Xml</ItemInclude><AssemblyName>System.Xml</AssemblyName></AssemblyReference><AssemblyReference><Guid>31f5470dead948af884834a187b5f2b7</Guid><ItemName>Reference</ItemName><ItemInclude>System.Design</ItemInclude><AssemblyName>System.Design</AssemblyName></AssemblyReference><AssemblyReference><Guid>d1c4cf23f51241809a6b0decbf479238</Guid><ItemName>Reference</ItemName><ItemInclude>System.Web</ItemInclude><AssemblyName>System.Web</AssemblyName></AssemblyReference><AssemblyReference><Guid>ee73838a6fe44757985cb500dc8be485</Guid><ItemName>Reference</ItemName><ItemInclude>System.Web.Services</ItemInclude><AssemblyName>System.Web.Services</AssemblyName></AssemblyReference><AssemblyReference><Guid>22113dc535c64ebe86312b34157a1f8c</Guid><ItemName>Reference</ItemName><ItemInclude>System.Transactions</ItemInclude><AssemblyName>System.Transactions</AssemblyName></AssemblyReference><AssemblyReference><Guid>16e59e89510a4d5581e3702de76966f4</Guid><ItemName>Reference</ItemName><ItemInclude>System.Drawing.Design</ItemInclude><AssemblyName>System.Drawing.Design</AssemblyName></AssemblyReference><AssemblyReference><Guid>208c7f517e7143afa8e8625efda954d5</Guid><ItemName>Reference</ItemName><ItemInclude>KO, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude><CopyLocal>0</CopyLocal><AssemblyName>KO, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName><Path>D:\Program Files (x86)\K2 blackpearl\bin\KO.dll</Path></AssemblyReference><AssemblyReference><Guid>98cfa667884b499da816ccd57d659cb6</Guid><ItemName>Reference</ItemName><ItemInclude>System.Workflow.ComponentModel</ItemInclude><AssemblyName>System.Workflow.ComponentModel</AssemblyName></AssemblyReference><AssemblyReference><Guid>43b3479c53b84cca85520848108bc425</Guid><ItemName>Reference</ItemName><ItemInclude>System.Workflow.Runtime</ItemInclude><AssemblyName>System.Workflow.Runtime</AssemblyName></AssemblyReference><AssemblyReference><Guid>de429ce3cbec4899bad610b22ba059a2</Guid><ItemName>Reference</ItemName><ItemInclude>System.Workflow.Activities</ItemInclude><AssemblyName>System.Workflow.Activities</AssemblyName></AssemblyReference><AssemblyReference><Guid>b3b860d9e9ba491ba4eb504de1599989</Guid><ItemName>Reference</ItemName><ItemInclude>DianPing.BPM.WFDevFx.K2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=e96472148ad4f04b</ItemInclude><AssemblyName>DianPing.BPM.WFDevFx.K2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=e96472148ad4f04b</AssemblyName></AssemblyReference><AssemblyReference><Guid>acc91b3ff5504cfc9b007b8527ca910c</Guid><ItemName>Reference</ItemName><ItemInclude>DianPing.BPM.Common, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9af3289ac427fbfa</ItemInclude><CopyLocal>0</CopyLocal><AssemblyName>DianPing.BPM.Common, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9af3289ac427fbfa</AssemblyName></AssemblyReference><AssemblyReference><Guid>d0473089e8414c318e69929caacf198a</Guid><ItemName>Reference</ItemName><ItemInclude>SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude><CopyLocal>0</CopyLocal><AssemblyName>SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName></AssemblyReference><AssemblyReference><Guid>c2419955870f4434a1f6e6788a846b67</Guid><ItemName>Reference</ItemName><ItemInclude>SourceCode.ResolverFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude><CopyLocal>0</CopyLocal><AssemblyName>SourceCode.ResolverFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName></AssemblyReference><AssemblyReference><Guid>8a6e2c7c141a4ea990c750d58d56b57d</Guid><ItemName>Reference</ItemName><ItemInclude>System.Core</ItemInclude><AssemblyName>System.Core</AssemblyName><RequiredFramework>3.5</RequiredFramework></AssemblyReference><AssemblyReference><Guid>7ef1102b850444f18de21204b5f06eda</Guid><ItemName>Reference</ItemName><ItemInclude>System.Xml.Linq</ItemInclude><AssemblyName>System.Xml.Linq</AssemblyName><RequiredFramework>3.5</RequiredFramework></AssemblyReference><AssemblyReference><Guid>2bf6f4d2a8dc449a998d77ef0061607e</Guid><ItemName>Reference</ItemName><ItemInclude>System.ServiceModel</ItemInclude><AssemblyName>System.ServiceModel</AssemblyName></AssemblyReference></References><ExecutionLayers><ExecutionLayer><ExecutableItems><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>f1dd0488a00e4d9d8e1e103266a356a3</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_83257c5261da4d4397bb4b78a6db01b9" x:Name="PrecedingRule_83257c5261da4d4397bb4b78a6db01b9" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>46f7d1ab1943441d9044228ac1c83170</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_83257c5261da4d4397bb4b78a6db01b9;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_83257c5261da4d4397bb4b78a6db01b9 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_83257c5261da4d4397bb4b78a6db01b9 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>83257c5261da4d4397bb4b78a6db01b9</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>d65cc5121abc42b493ef5540d985a178</Guid><MetaData /><Parent ref="5d4e06c0-b05b-49f3-b4c3-ff6f298e0f64&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>3a7a75b81b4e495eaf334b990a9f489e</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_6d3991b281c943ce9b8881e04b1b844e" x:Name="StartRule_6d3991b281c943ce9b8881e04b1b844e" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>3c7c1371337e44e1806f3b6c697e7849</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_6d3991b281c943ce9b8881e04b1b844e;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_6d3991b281c943ce9b8881e04b1b844e : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_6d3991b281c943ce9b8881e04b1b844e K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>6d3991b281c943ce9b8881e04b1b844e</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>e902456e62454a778312901544fcfb4c</Guid><MetaData /><Parent ref="5d4e06c0-b05b-49f3-b4c3-ff6f298e0f64&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>a83dc757d3444926a3dde7abaec4d993</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_4b527ea80388447a8cee9ea60b69810d" x:Name="DestinationRule_4b527ea80388447a8cee9ea60b69810d" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>84e30dc16d8c4931906cc5eed4d60193</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_4b527ea80388447a8cee9ea60b69810d;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_4b527ea80388447a8cee9ea60b69810d : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_4b527ea80388447a8cee9ea60b69810d K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>4b527ea80388447a8cee9ea60b69810d</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1628d463c5664974a2632437def3c5c0</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>67cb2a78cfa94e399c93daf4c434b735</Guid><MetaData /><Parent ref="5d4e06c0-b05b-49f3-b4c3-ff6f298e0f64&#xD;" /></SimpleDestinationRule><SimpleSucceedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>d4ab4c640e8f48bda89b4335f2ec682b</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_5897189e7f804b10aa2f7ba76321bf4b" x:Name="SucceedingRule_5897189e7f804b10aa2f7ba76321bf4b" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>3c530ef33b5e4c86b8522ec6ac208c33</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5897189e7f804b10aa2f7ba76321bf4b;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_5897189e7f804b10aa2f7ba76321bf4b : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5897189e7f804b10aa2f7ba76321bf4b K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.SucceedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>5897189e7f804b10aa2f7ba76321bf4b</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bad5563e78894ee099ecdacbe818013f</Guid></Rule><Guid>4ffb8314964a4ea9a55ba624c2fd156d</Guid><MetaData /><Parent ref="5d4e06c0-b05b-49f3-b4c3-ff6f298e0f64&#xD;" /></SimpleSucceedingRule><ServerEventItem Type="SourceCode.Workflow.Design.ServerEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.CodeExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>c4d74d98a8404788bb11453dc71590cb</Guid><OriginalFileName>@safeitemname@.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_227a4a9e333b4009b2fc97eb2a03a717;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
    public partial class EventItem_227a4a9e333b4009b2fc97eb2a03a717 : ICodeExtender<hostContext>
	{
        public void Main(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_227a4a9e333b4009b2fc97eb2a03a717 K2)
        {
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.Initialize();

        }
    }
}
]]></Content></CodeFile></CodeFiles><Guid>227a4a9e333b4009b2fc97eb2a03a717</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><ContextMode>CustomContext</ContextMode><Language>CSharp</Language></Extender><Guid>5641ca9c444f469581933a1a574e6c90</Guid><MetaData /><Parent ref="3731415a-97fe-45ee-ba38-58bc84dd234f&#xD;" /></ServerEventItem><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>6af8a5f95fc04c61a869c61f31e6eaff</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_030ca82d7810407ebf506d3aa17c531f" x:Name="PrecedingRule_030ca82d7810407ebf506d3aa17c531f" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>88e4d1707a9a42a7b5f8a41120bb02c2</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_030ca82d7810407ebf506d3aa17c531f;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_030ca82d7810407ebf506d3aa17c531f : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_030ca82d7810407ebf506d3aa17c531f K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>030ca82d7810407ebf506d3aa17c531f</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>4deaf865a5cb4cde8169d5b4f8c093c3</Guid><MetaData /><Parent ref="43cde613-cb03-4d1a-91ae-5075924cd4e4&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>920bc4e60b0d484da5ed8229e0f5e15a</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_d9f4615ccea842fda66764411cc4dc75" x:Name="StartRule_d9f4615ccea842fda66764411cc4dc75" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>75f3292cc028460eaf548fc84b6ae00a</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_d9f4615ccea842fda66764411cc4dc75;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_d9f4615ccea842fda66764411cc4dc75 : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_d9f4615ccea842fda66764411cc4dc75 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>d9f4615ccea842fda66764411cc4dc75</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>890a8e7d0a1045b89c6963671f8054d3</Guid><MetaData /><Parent ref="43cde613-cb03-4d1a-91ae-5075924cd4e4&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>0f894e0bb9af48d7bb192ea1f7258d5f</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_eb042288f3a8437096ae74f7208630c2" x:Name="DestinationRule_eb042288f3a8437096ae74f7208630c2" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>667be8a1b25d4012a8f9d9d370487c1f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_eb042288f3a8437096ae74f7208630c2;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_eb042288f3a8437096ae74f7208630c2 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_eb042288f3a8437096ae74f7208630c2 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
            
            K2.ResolveQueuesToUsers = false;

            string dests = string.Format("{0};{1}",
                                            K2.ProcessInstance.Originator.Name, 
                                            K2.ProcessInstance.DataFields["dest_Creator"].Value.ToString());
            K2Context k2content = new K2Context(K2.Destinations, K2.ActivityInstance);
            k2content.InitDestination(dests);
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>eb042288f3a8437096ae74f7208630c2</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Destinations><Destination Type="SourceCode.Workflow.Design.SimpleRules.Destination" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2a2d32e25e664333a7074b93917fe1aa</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[0]]></Value></ValueTypePart></Parts><Guid>dd340fb2aff24dea9fe507f0544ca447</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>255de2738e86435d96de8159452a1fd6</Guid></Destination></Destinations><Guid>9b9d4d3c99834ef28c01c6be360188a0</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>f57cfc31f0034fb6af28e96ed3932f84</Guid><MetaData /><Parent ref="43cde613-cb03-4d1a-91ae-5075924cd4e4&#xD;" /></SimpleDestinationRule><DefaultOutcomeSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>31be0a76fa2c4f15acae898184ff0f68</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_2e55d89bfa7e4396b251d0b984685854" x:Name="SucceedingRule_2e55d89bfa7e4396b251d0b984685854" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<IfElseActivity x:Name="RuleOutcome">
		<IfElseBranchActivity x:Name="RuleOutcomeTrue">
			<IfElseBranchActivity.Condition>
				<CodeCondition Condition="EvaluateRule" />
			</IfElseBranchActivity.Condition>
			<CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
		</IfElseBranchActivity>
		<IfElseBranchActivity x:Name="RuleOutcomeFalse">
			<CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
		</IfElseBranchActivity>
	</IfElseActivity>
	
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>74b23c96dc0b4f778470be9188ab0d81</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2e55d89bfa7e4396b251d0b984685854;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_2e55d89bfa7e4396b251d0b984685854 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2e55d89bfa7e4396b251d0b984685854 K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

            		e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>f9aa3b2914a84bfebaa23d27b45768e8</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_2e55d89bfa7e4396b251d0b984685854
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2e55d89bfa7e4396b251d0b984685854 K2)
			{
				bool retval = false;
                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Started");
    			for (int i = 0; i < K2.Configuration.SetCount; i++)
    			{
        			if (GetRuleResult(K2, i))
        			{
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Event Evaluation Result: " + GetName(K2,i));
            			SetOutcomeResult(K2, GetName(K2,i));
          				retval = true;
		                break;
        			} 

    			}

                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Completed");
				return retval;
			}

			public static void SetOutcomeResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2e55d89bfa7e4396b251d0b984685854 K2, string value)
			{
				K2.ActivityInstance.DataFields["Outcome"].Value = value;	
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2e55d89bfa7e4396b251d0b984685854 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2e55d89bfa7e4396b251d0b984685854 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>2e55d89bfa7e4396b251d0b984685854</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1c50b07ed967458d824fc81b3443f64a</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="802af15f-879c-4a85-b5f3-6f47d5f69e61&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>1e532af3ff694c009623117ba4cd5652</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>f0a4798f27294c14b672368f63c17c54</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3cd6d4b766ba4856ada29cf6f26470c0</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[重新提交]]></Value></ValueTypePart></Parts><Guid>359fea1f630b4d99b9e99081f585fdf5</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>837bc4d15da84e61b5219ccb18d703cd</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2cccd4530db24a20b672c245b159bf69</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>bbf4b0ae20cf40f4911b555eca42489c</Guid></Count><Guid>e85c51f1404f467eaa0f2e3927dfe1f8</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>6d494be050924aa8b66448f446d63e1d</Guid></ExpressionLevelPair></Expressions><Guid>1f9acade800a456d8c28f2a9e5071bfa</Guid></Rule><Guid>de0afe532b53461aa7797af875b03269</Guid><Name>重新提交</Name><Description>Default Outcome generated originally from the 重新提交 Action.</Description></OutcomeItem><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a45f749cbf4d48d2ae8705adbe47a8d7</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="802af15f-879c-4a85-b5f3-6f47d5f69e61&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>All</ListOption></DataFieldPart></Parts><Guid>b1b1573eb80e4d2cbdb67f415f42a3da</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>da539c80544b443893d14ce303f2d23f</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d18bd33577c24b4a8857ec7209834c1e</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[结束流程]]></Value></ValueTypePart></Parts><Guid>6e6401fcf19b490b9eba2c218c2803e2</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>efd06fab67ad420f82bbb17f115d5db9</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0721de3266ed4ac4a36b82e37395c170</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[1]]></Value></ValueTypePart></Parts><Guid>b7cca3286c2048bb89511efd44a67545</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>94f1b14c15dd410d8b4befe0468ce6be</Guid></Count><Guid>ce2ed516eccd4002909dc72c541cb782</Guid><Operator>Equal</Operator><ListOperator>AtLeast</ListOperator></Exp><Guid>b48c1f18abe54afebd6e868fcccd19e7</Guid></ExpressionLevelPair></Expressions><Guid>e6054c811e364d17b842d8d31be26b0c</Guid></Rule><Guid>8391400a467e49618b36d43b90c07fba</Guid><Name>结束流程</Name><Description>Default Outcome generated originally from the 退回 Action.</Description></OutcomeItem></Outcomes><Guid>8f8198ed8b2a459ea3a7c292fa53c459</Guid><MetaData /><Parent ref="43cde613-cb03-4d1a-91ae-5075924cd4e4&#xD;" /></DefaultOutcomeSucceedingRule><ClientEventItem Type="SourceCode.Workflow.Design.ClientEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>74ff7ec07c884940a0fed18f88f59491</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventItem_09b29045517040319e2904bfa800eb65" x:Name="EventItem_09b29045517040319e2904bfa800eb65" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToInternet</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToMobile</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToExchange</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="ClientEventActivity">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="SendToInternet" ExecuteCode="SendWorkToInternet">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToInternet" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToMobile" ExecuteCode="SendWorkToMobile">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToMobile" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToExchange" ExecuteCode="SendWorkToExchange">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToExchange" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>

</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>923c25b8744046eaa221518021dc45ac</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_09b29045517040319e2904bfa800eb65;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventItem_09b29045517040319e2904bfa800eb65 : IWorkflowContext<hostContext>
    {

		private bool internetExecuted = false;
        private bool mobileExecuted = false;
        private bool exchangeExecuted = false;
		private bool AllowAnyUserToFinishEventDone = false;

        #region K2 Context

        private hostContext _k2;

        #endregion

		#region Client Event Activity

		 private void UntilCondition(object sender, ConditionalEventArgs e)
        {
			if (!AllowAnyUserToFinishEventDone)
            {
                if (Convert.ToBoolean(K2.Configuration.AllowAnyUserToFinishEvent))
                {
                    K2.VerifyCredentials = false;
                }
                else
                {
                    K2.VerifyCredentials = true;
                }
                AllowAnyUserToFinishEventDone = true;

                K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
                k2context.BeforeAction(K2.Configuration.InternetUrl, MessageClass.Reject);
            }
            if (internetExecuted && mobileExecuted && exchangeExecuted)
            {
                e.Result = true;
            }
            else
            {
                e.Result = false;
            }
        }
		#endregion

        #region Internet

		private void ShouldSendToInternet(object sender, ConditionalEventArgs e)
        {
            internetExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToInternet);
        }

        private void SendWorkToInternet(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.InternetUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.InternetPlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
            
        }
        #endregion

        #region Mobile
        private void SendWorkToMobile(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.MobileUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.MobilePlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
        }

        private void ShouldSendToMobile(object sender, ConditionalEventArgs e)
        {
            mobileExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToMobile);
        }
        #endregion

        #region Exchange

        private void ShouldSendToExchange(object sender, ConditionalEventArgs e)
        {
            exchangeExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToExchange);
        }

        private void SendWorkToExchange(object sender, EventArgs e)
        {
            K2.AddWorklist("EXCHANGEPROFILENAME", K2.Configuration.ExchangeProfileName);
            K2.AddWorklist("EXCHANGEFORMTYPE", K2.Configuration.ExchangeFormType);
            
        }

        #endregion


        #region Other Methods

        #endregion


        #region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_09b29045517040319e2904bfa800eb65 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>09b29045517040319e2904bfa800eb65</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><NotificationMessage Type="SourceCode.Workflow.Authoring.NotificationMessage" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b334ea3f6c9b46faa2309851fc542dc5</Guid></NotificationMessage><InternetUrl Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>298d7ef780e74b6ab2a61e11aae82a08</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="5509b952-2b87-45e6-ab23-66cdf2e6e5e9&#xD;" /><DataFieldName>ActionURL</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>73f611c46d534844b2d76322cdb8c6af</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[?]]></Value></ValueTypePart><SerialNoFieldPart Type="SourceCode.Workflow.Design.SerialNoFieldPart" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ceb4de01865a41ddaad3cc0003f1154c</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value>SN={SERIALNO}</Value></SerialNoFieldPart><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>86ff9163366e493ca2b132b6498045af</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[&restart=1]]></Value></ValueTypePart></Parts><Guid>e9eb63ec9e7f42e481f890660b7cb380</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></InternetUrl><Guid>551ee993955f478786779ac1a5f26bb9</Guid><MetaData /><Parent ref="1c0fd53a-7e2c-4ee3-9a3c-2e73c2484ee0&#xD;" /><SendToInternet>1</SendToInternet><InternetPlatform>ASP</InternetPlatform><MobilePlatform>ASP</MobilePlatform></ClientEventItem><DefaultOutcomeEventSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeEventSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>ad5101d9b1f14fe69b9d1d52e6825288</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRule_df66e05f47ec4ec9a29b33b20578e0f4" x:Name="EventSucceedingRule_df66e05f47ec4ec9a29b33b20578e0f4" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ns0:WorkflowContext.LockedActivities>
    <x:Array Type="{x:Type System.String}">
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
    </x:Array>
  </ns0:WorkflowContext.LockedActivities>
  <IfElseActivity x:Name="RuleOutcome">
    <IfElseBranchActivity x:Name="RuleOutcomeTrue">
      <IfElseBranchActivity.Condition>
        <CodeCondition Condition="EvaluateRule" />
      </IfElseBranchActivity.Condition>
      <CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
    </IfElseBranchActivity>
    <IfElseBranchActivity x:Name="RuleOutcomeFalse">
      <CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
    </IfElseBranchActivity>
  </IfElseActivity>

</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>3e20b345be57493bb3ef5491af1b178b</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_df66e05f47ec4ec9a29b33b20578e0f4;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_df66e05f47ec4ec9a29b33b20578e0f4 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_df66e05f47ec4ec9a29b33b20578e0f4 K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                    e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
                }
                else
                {
                    e.Result = true;
                }
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>e00a45cc1275455c806db3b9853366fc</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_df66e05f47ec4ec9a29b33b20578e0f4
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_df66e05f47ec4ec9a29b33b20578e0f4 K2)
			{
                bool retval = false;
                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Started");
            			for (int i = 0; i < K2.Configuration.SetCount; i++)
            			{
                			if (GetRuleResult(K2, i))
                			{
                                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Event Evaluation Result: " + GetName(K2,i));
                  				retval = true;
				                break;
                			} 

            			}
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Completed");
                } 
                else 
                {
                    retval = true;
                }
				return retval;
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_df66e05f47ec4ec9a29b33b20578e0f4 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_df66e05f47ec4ec9a29b33b20578e0f4 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>df66e05f47ec4ec9a29b33b20578e0f4</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>cb7211609dcf4bd0b094ebcbc089f1f5</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="802af15f-879c-4a85-b5f3-6f47d5f69e61&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>2311d387c9194446b0ac59858a222882</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>93b44b69e9cb405c8f07e6797f28d893</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1636c27d85824ec69bd5b0905ce6aa0b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[重新提交]]></Value></ValueTypePart></Parts><Guid>3843c32006c040e896e1b79d4496c065</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>c2f61b82c7d34c0d9c3d5ecd15ec61ec</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>4e3691233ccf4c95961510a564b0992b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>bde26d310d734cd18cbd789e6f3f7c67</Guid></Count><Guid>8a2430d0216044058ce0a4bb0a172bd9</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>cd23150967e4446795ebfd9191dd8abc</Guid></ExpressionLevelPair></Expressions><Guid>4eb6e47ab1ff471790a3cacf99dd79ff</Guid></Rule><Guid>f5dff7418d01407fa90fc21a5ed540a6</Guid><Name>重新提交</Name><Description>Default Outcome generated originally from the 重新提交 Action.</Description></OutcomeItem><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>11093442fd4046578f86a9fb34436c66</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="802af15f-879c-4a85-b5f3-6f47d5f69e61&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>All</ListOption></DataFieldPart></Parts><Guid>d7a2053f74994cc0b91af4a6a790b02e</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>744acf7a2ec047e3afd042e5bced0978</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>07cef9afe07c4419a9d852897119459b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[结束流程]]></Value></ValueTypePart></Parts><Guid>e4819c6135664efdba00b744f861a767</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>2c7e58e7bb394986940e7aeae7cfb899</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>293edec2f56f4bfab12448649d6b7b62</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[1]]></Value></ValueTypePart></Parts><Guid>c788c3f18fcd4cb098cb2496ed1dd454</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>f3681c86ffa148568db3e0e821a02bba</Guid></Count><Guid>391aa0dc5b3b44e7b819e41226a40c28</Guid><Operator>Equal</Operator><ListOperator>AtLeast</ListOperator></Exp><Guid>4502d8a580834ee3b62d4d04b7b389ab</Guid></ExpressionLevelPair></Expressions><Guid>00885572ad06463ca9065092610fa4cd</Guid></Rule><Guid>f2ce65d93711487493f2bc55db79b2ae</Guid><Name>结束流程</Name><Description>Default Outcome generated originally from the 退回 Action.</Description></OutcomeItem></Outcomes><Guid>851072ef073f475eb14b843db3022ddc</Guid><MetaData /><Parent ref="1c0fd53a-7e2c-4ee3-9a3c-2e73c2484ee0&#xD;" /></DefaultOutcomeEventSucceedingRule><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>7feacbb243f9457480a0ca9ea0260c40</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_21d155869c0b480c95572dc3d163688b" x:Name="ActionItem_21d155869c0b480c95572dc3d163688b" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>9b3b045774934c1fa5fcd46413844a02</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_21d155869c0b480c95572dc3d163688b;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_21d155869c0b480c95572dc3d163688b : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_21d155869c0b480c95572dc3d163688b K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>bd9d2d163b1e41da92c48cbc890525a1</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_21d155869c0b480c95572dc3d163688b
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_21d155869c0b480c95572dc3d163688b K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_21d155869c0b480c95572dc3d163688b K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>21d155869c0b480c95572dc3d163688b</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>a792de7d03074634a8121049e4b00523</Guid><MetaData /><Parent ref="cd52caed-1809-498a-b9ce-35e694eb3e72&#xD;" /></DefaultOutcomeAction><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>ee3fb6188da740c4af90dcd15ff71dce</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_8c1b1ef7f32f4086b5720d0be9a7d078" x:Name="ActionItem_8c1b1ef7f32f4086b5720d0be9a7d078" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>ebcf210375fc4441aa298fafacd905ee</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8c1b1ef7f32f4086b5720d0be9a7d078;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_8c1b1ef7f32f4086b5720d0be9a7d078 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8c1b1ef7f32f4086b5720d0be9a7d078 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
            
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>64d658b702c045e0a24847be53b84c2b</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_8c1b1ef7f32f4086b5720d0be9a7d078
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8c1b1ef7f32f4086b5720d0be9a7d078 K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8c1b1ef7f32f4086b5720d0be9a7d078 K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>8c1b1ef7f32f4086b5720d0be9a7d078</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>7599189bcc644a3fa6655b1ec70bcc1b</Guid><MetaData /><Parent ref="6ad263fc-cc57-4b61-9236-81947e2614fa&#xD;" /></DefaultOutcomeAction><SimpleLineRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>7f8276e6006747c187a934d8cbc209af</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.LineRule_f36604e6732f4156af346be2cb586e74" x:Name="LineRule_f36604e6732f4156af346be2cb586e74" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>6d20049dfa4246f191dfc71516e014a8</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_f36604e6732f4156af346be2cb586e74;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class LineRule_f36604e6732f4156af346be2cb586e74 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_f36604e6732f4156af346be2cb586e74 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.LineRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>f36604e6732f4156af346be2cb586e74</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>29a5484272704116b9144754d5500722</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="f0688f63-8b75-41a1-b1e3-31cb7f840c3a&#xD;" /><DataFieldName>Outcome</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart></Parts><Guid>4c4eb804f26e4b70b8eb78a6c1b457b7</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>6b3476e9553a487b9565be96deb873a3</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>27cb904bd3894e699cc48d25a580a532</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[重新提交]]></Value></ValueTypePart></Parts><Guid>66d9470833bb4feea3d7c9f37f4a3f04</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>f0bcf3b9023341bba399099f92811629</Guid></Right><Guid>49a0c0e4e76a4ad187c9f45560531bc5</Guid><Operator>Equal</Operator></Exp><Guid>115bfc47d7644cdfb57020b426f89e6d</Guid></ExpressionLevelPair></Expressions><Guid>754285533d3e41e39651ed4cb18f2009</Guid></Rule><Guid>35fbecfb561644b984e692a80abcd628</Guid><MetaData /><Parent ref="54bb9fda-2584-41b2-9e72-9563d14de5ee&#xD;" /></SimpleLineRule><SimpleLineRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>f73c4c877ebf41f790337aeba348da5b</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.LineRule_db14409cd2374b0384e9b7b3edeb714b" x:Name="LineRule_db14409cd2374b0384e9b7b3edeb714b" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>5d136ee8f6184c249702cc1d6481a624</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_db14409cd2374b0384e9b7b3edeb714b;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class LineRule_db14409cd2374b0384e9b7b3edeb714b : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_db14409cd2374b0384e9b7b3edeb714b K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.LineRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>db14409cd2374b0384e9b7b3edeb714b</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a23ad1bc45774532b21d9996fdaa4991</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="f0688f63-8b75-41a1-b1e3-31cb7f840c3a&#xD;" /><DataFieldName>Outcome</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart></Parts><Guid>e85480a5dfea4d838b52cf488852bc11</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>dd2bfdf275c44d6c81e6a2074879d01b</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>dfd9492d6e6545b4afd7f0bce181fdfa</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[结束流程]]></Value></ValueTypePart></Parts><Guid>dde7313a003f46de9426d7b4067e0a10</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>e49eb345300648fb87ecc3738a282624</Guid></Right><Guid>541c93c75aeb4f83a5b383939f62bdbe</Guid><Operator>Equal</Operator></Exp><Guid>35ac21d6fbf54ae8bc0b3b34c2612ca4</Guid></ExpressionLevelPair></Expressions><Guid>1743affecf554a69ada45666f8d9a92b</Guid></Rule><Guid>44428eeebdca4b8eb00037cfc4a1d37f</Guid><MetaData /><Parent ref="2ce76362-3a13-4907-93ce-cc703db886b5&#xD;" /></SimpleLineRule><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>039c1578f0284b0e9a246e0867567473</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_b5177533733a42bab8148e441453e0f1" x:Name="PrecedingRule_b5177533733a42bab8148e441453e0f1" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>39095be59f7d4246a86350a284d17714</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_b5177533733a42bab8148e441453e0f1;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_b5177533733a42bab8148e441453e0f1 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_b5177533733a42bab8148e441453e0f1 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>b5177533733a42bab8148e441453e0f1</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>37a513c4ae1341028f14e35728049e02</Guid><MetaData /><Parent ref="f154d5f6-b4e2-4e54-a80c-9f558d0457f4&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>8d83dc3790f64b29a0dd4984b8c7a27d</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_c0b9646959ec425f9a30a1e13757d211" x:Name="StartRule_c0b9646959ec425f9a30a1e13757d211" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>0d346f0568934081953d175a41c7ac25</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_c0b9646959ec425f9a30a1e13757d211;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_c0b9646959ec425f9a30a1e13757d211 : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_c0b9646959ec425f9a30a1e13757d211 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>c0b9646959ec425f9a30a1e13757d211</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>926cc9591ff04666be91eb6b2fc6bcf1</Guid><MetaData /><Parent ref="f154d5f6-b4e2-4e54-a80c-9f558d0457f4&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>70cbbb76f76a43ffb4043ff59d24569c</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_e630fbc0fde4471fb888b0f85db62985" x:Name="DestinationRule_e630fbc0fde4471fb888b0f85db62985" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>86d3dcc4b2984a469121f0ca450c2e38</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_e630fbc0fde4471fb888b0f85db62985;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_e630fbc0fde4471fb888b0f85db62985 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_e630fbc0fde4471fb888b0f85db62985 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>e630fbc0fde4471fb888b0f85db62985</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>8bc9170d5eee4612974705e6778d1d07</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>19a69b1e9ffd48499fe8ed1d5f3fb1eb</Guid><MetaData /><Parent ref="f154d5f6-b4e2-4e54-a80c-9f558d0457f4&#xD;" /></SimpleDestinationRule><SimpleSucceedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>00747f552af346a691d06fdb8feee399</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_b00890da8bca42cb8a646f63f17ff4cb" x:Name="SucceedingRule_b00890da8bca42cb8a646f63f17ff4cb" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>66f9b8a3dd90497ba6fa636bf19a1fef</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_b00890da8bca42cb8a646f63f17ff4cb;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_b00890da8bca42cb8a646f63f17ff4cb : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_b00890da8bca42cb8a646f63f17ff4cb K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.SucceedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>b00890da8bca42cb8a646f63f17ff4cb</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>14f712bafebe4798a43eafa6ffb7cad4</Guid></Rule><Guid>0aeb13737fb647fbbc36402861cce079</Guid><MetaData /><Parent ref="f154d5f6-b4e2-4e54-a80c-9f558d0457f4&#xD;" /></SimpleSucceedingRule><ServerEventItem Type="SourceCode.Workflow.Design.ServerEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.CodeExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>fc7de0a9bb32422ba7e2e838be8d751c</Guid><OriginalFileName>@safeitemname@.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_4060743642a648529059753e3ff617e2;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
    public partial class EventItem_4060743642a648529059753e3ff617e2 : ICodeExtender<hostContext>
	{
        public void Main(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_4060743642a648529059753e3ff617e2 K2)
        {
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.RejectProcess();
        }
    }
} 
]]></Content></CodeFile></CodeFiles><Guid>4060743642a648529059753e3ff617e2</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><ContextMode>CustomContext</ContextMode><Language>CSharp</Language></Extender><Guid>c19ec0d72e0042f0a796f4eb1140881b</Guid><MetaData /><Parent ref="f7d1af2e-2a65-4c9d-834f-f6c9ae167d30&#xD;" /></ServerEventItem><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>fe16f2a6bfcb43c3b01283b878f14bb0</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_101e5899391d40e2a309d0d15a2b0ba2" x:Name="PrecedingRule_101e5899391d40e2a309d0d15a2b0ba2" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>71fa841b92194bb994124fb71cee57bf</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_101e5899391d40e2a309d0d15a2b0ba2;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_101e5899391d40e2a309d0d15a2b0ba2 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_101e5899391d40e2a309d0d15a2b0ba2 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>101e5899391d40e2a309d0d15a2b0ba2</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>6c20d7ff76b5444282424651d9a97957</Guid><MetaData /><Parent ref="a86b3c69-97ae-4cae-bc6f-ddb9c1287aab&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>fdcddf154c004b5a9e90788f01dcda10</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_84cb3c6a19f24cdbbbcb8ef5bdc1e365" x:Name="StartRule_84cb3c6a19f24cdbbbcb8ef5bdc1e365" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>7cf210c726d34815aaeb4bbd7f0b1ea3</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_84cb3c6a19f24cdbbbcb8ef5bdc1e365;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_84cb3c6a19f24cdbbbcb8ef5bdc1e365 : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_84cb3c6a19f24cdbbbcb8ef5bdc1e365 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>84cb3c6a19f24cdbbbcb8ef5bdc1e365</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>3afed60896e34de59f86daf269e1a262</Guid><MetaData /><Parent ref="a86b3c69-97ae-4cae-bc6f-ddb9c1287aab&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>ac1c7f3c55504d1d9b3d992321503fe9</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_5f4b23b4ffbd49e09ad9583ca0517582" x:Name="DestinationRule_5f4b23b4ffbd49e09ad9583ca0517582" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>ee943338383542a8b3f2c01938bdf02f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_5f4b23b4ffbd49e09ad9583ca0517582;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_5f4b23b4ffbd49e09ad9583ca0517582 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_5f4b23b4ffbd49e09ad9583ca0517582 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>5f4b23b4ffbd49e09ad9583ca0517582</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d6e4f9f0a3234cd0a106ee7bbcad7920</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>a5503454c67e4daf90144095da2dc266</Guid><MetaData /><Parent ref="a86b3c69-97ae-4cae-bc6f-ddb9c1287aab&#xD;" /></SimpleDestinationRule><SimpleSucceedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>9e4a92df264945538eb37c3418f587ee</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_6bd4d65e8e01490d9af09de5f58a57c1" x:Name="SucceedingRule_6bd4d65e8e01490d9af09de5f58a57c1" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>970a5e7366f343deb9ec91a93422286f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_6bd4d65e8e01490d9af09de5f58a57c1;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_6bd4d65e8e01490d9af09de5f58a57c1 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_6bd4d65e8e01490d9af09de5f58a57c1 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.SucceedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>6bd4d65e8e01490d9af09de5f58a57c1</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bd83c40a8f604faabade298e705711da</Guid></Rule><Guid>cd75baa2f3bc4c358744ee25235419b4</Guid><MetaData /><Parent ref="a86b3c69-97ae-4cae-bc6f-ddb9c1287aab&#xD;" /></SimpleSucceedingRule><ServerEventItem Type="SourceCode.Workflow.Design.ServerEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.CodeExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>91e6d911b1704743a6afa2d27f4591c6</Guid><OriginalFileName>@safeitemname@.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_442ac8b1c2924f5684095a4a6497161f;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
    public partial class EventItem_442ac8b1c2924f5684095a4a6497161f : ICodeExtender<hostContext>
	{
        public void Main(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_442ac8b1c2924f5684095a4a6497161f K2)
        {
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.ReStartProcess();
        }
    }
} 
]]></Content></CodeFile></CodeFiles><Guid>442ac8b1c2924f5684095a4a6497161f</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><ContextMode>CustomContext</ContextMode><Language>CSharp</Language></Extender><Guid>d3c6c848c829442fa9e8c9a6cf3c55cd</Guid><MetaData /><Parent ref="969129ce-b917-417a-a3a5-c6984df62cf7&#xD;" /></ServerEventItem><SimpleLineRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>67e433353f154086b735825cc5c44ab6</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.LineRule_a3036f25f25644958eaafd7bc9180d9d" x:Name="LineRule_a3036f25f25644958eaafd7bc9180d9d" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>2189e3cec74d459abf8e8570be3d4559</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_a3036f25f25644958eaafd7bc9180d9d;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class LineRule_a3036f25f25644958eaafd7bc9180d9d : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_a3036f25f25644958eaafd7bc9180d9d K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.LineRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>a3036f25f25644958eaafd7bc9180d9d</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9933a7e9b53a4eceaa18e81557346361</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="5f1dc9b6-100f-470c-abe4-75e59af89500&#xD;" /><DataFieldName>WFState</DataFieldName><Scope>Process</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart></Parts><Guid>7779d29df08a45ceb76f1df2f3a6fa4b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>115b8ae294a948e0842cb1381b518eb4</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><FunctionFieldPart Type="SourceCode.Workflow.Functions.Design.FunctionFieldPart" Assembly="SourceCode.Workflow.Functions.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Functions.Wizard.FunctionFieldPartDefinition" Assembly="SourceCode.Workflow.Functions.Wizard, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3bc76f6bc7154eeba04c3de7435478d9</Guid><Name>{ef40f735-966d-487a-a960-371da465f3ea}</Name><RegisteredItem>Function FieldPart Wizard</RegisteredItem></WizardDefinition><Guid>1900fa50f07a41d2844efba257798cfa</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><MethodPath>SourceCode.Workflow.Functions.TextManipulation, SourceCode.Workflow.Functions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d|EmptyString</MethodPath><ReturnType>System.String</ReturnType><Name>Empty String</Name><Desc>Returns an empty string.</Desc></FunctionFieldPart></Parts><Guid>2f38b96a54f94447aa8557f0df7d0121</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>b7b1dcb8428e414fb5c24d1691444b7c</Guid></Right><Guid>a654ee4310ab41beaa6251e3ba613a30</Guid><Operator>NotEqual</Operator></Exp><Guid>7ce00a9d846946818dfb8354e087ab3d</Guid></ExpressionLevelPair></Expressions><Guid>81094409dccb4955844aa8c5814e4e64</Guid></Rule><Guid>f9023b081c8b424a99e5dd9e303367eb</Guid><MetaData /><Parent ref="d0281720-42f9-40de-8366-62eb363d01ba&#xD;" /></SimpleLineRule><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>3b72787dc2a54c82a119930848270728</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_48916aa7addb453ab2d2f24d430dd8e1" x:Name="PrecedingRule_48916aa7addb453ab2d2f24d430dd8e1" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>a317d658cfec4f28bc3d7425ee0877b3</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_48916aa7addb453ab2d2f24d430dd8e1;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_48916aa7addb453ab2d2f24d430dd8e1 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_48916aa7addb453ab2d2f24d430dd8e1 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>48916aa7addb453ab2d2f24d430dd8e1</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>c84d633fdd264dae85daf2c0eb58e710</Guid><MetaData /><Parent ref="ba7c0334-6c7d-4419-ba00-9b2c31cd0435&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>ae58b703f76447e0b3161af5645a4416</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_c6a9af7520654fa2bd23991083e048b9" x:Name="StartRule_c6a9af7520654fa2bd23991083e048b9" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>4f5638d30116427a8612e18bf3c76539</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_c6a9af7520654fa2bd23991083e048b9;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_c6a9af7520654fa2bd23991083e048b9 : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_c6a9af7520654fa2bd23991083e048b9 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>c6a9af7520654fa2bd23991083e048b9</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>2478fb4498394fec86c174ed8f850ad7</Guid><MetaData /><Parent ref="ba7c0334-6c7d-4419-ba00-9b2c31cd0435&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>8fa5bc27399c4c46b4b708d6fbe51670</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_8cab88e7024b4f339cadecd0a36ad443" x:Name="DestinationRule_8cab88e7024b4f339cadecd0a36ad443" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>87358790e2d54b17af1ddaf45ad61ca5</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_8cab88e7024b4f339cadecd0a36ad443;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_8cab88e7024b4f339cadecd0a36ad443 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_8cab88e7024b4f339cadecd0a36ad443 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
            
            K2.ResolveQueuesToUsers = false;

            string dests = K2.ProcessInstance.DataFields["dest_citymanager"].Value.ToString();
            K2Context k2content = new K2Context(K2.Destinations, K2.ActivityInstance);
            k2content.InitDestination(dests);
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>8cab88e7024b4f339cadecd0a36ad443</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Destinations><Destination Type="SourceCode.Workflow.Design.SimpleRules.Destination" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6959dcf45c9b48eb8b570d787b883a9a</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[-1]]></Value></ValueTypePart></Parts><Guid>c766479c5ac4431192adec8f3f17ae79</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>83149315535a42ae895bbb6be90700be</Guid><DestinationType>Group</DestinationType></Destination></Destinations><Guid>bebfcfd28c654eae9a32c01013af2605</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>31061216322a4cc39b0a6a97a98b64ea</Guid><MetaData /><Parent ref="ba7c0334-6c7d-4419-ba00-9b2c31cd0435&#xD;" /></SimpleDestinationRule><DefaultOutcomeSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>4545cc8fb1924a99bc88fa0bc0b711dd</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_ae178fa5e30f40bf9dd229760a2ba2dd" x:Name="SucceedingRule_ae178fa5e30f40bf9dd229760a2ba2dd" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<IfElseActivity x:Name="RuleOutcome">
		<IfElseBranchActivity x:Name="RuleOutcomeTrue">
			<IfElseBranchActivity.Condition>
				<CodeCondition Condition="EvaluateRule" />
			</IfElseBranchActivity.Condition>
			<CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
		</IfElseBranchActivity>
		<IfElseBranchActivity x:Name="RuleOutcomeFalse">
			<CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
		</IfElseBranchActivity>
	</IfElseActivity>
	
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>273f18d6e4b541b5b24d7caaee0f4c0f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_ae178fa5e30f40bf9dd229760a2ba2dd;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_ae178fa5e30f40bf9dd229760a2ba2dd : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_ae178fa5e30f40bf9dd229760a2ba2dd K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

            		e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>db3e8ace63d047d3a86d3bbc839926b9</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_ae178fa5e30f40bf9dd229760a2ba2dd
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_ae178fa5e30f40bf9dd229760a2ba2dd K2)
			{
				bool retval = false;
                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Started");
    			for (int i = 0; i < K2.Configuration.SetCount; i++)
    			{
        			if (GetRuleResult(K2, i))
        			{
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Event Evaluation Result: " + GetName(K2,i));
            			SetOutcomeResult(K2, GetName(K2,i));
          				retval = true;
		                break;
        			} 

    			}

                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Completed");
				return retval;
			}

			public static void SetOutcomeResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_ae178fa5e30f40bf9dd229760a2ba2dd K2, string value)
			{
				K2.ActivityInstance.DataFields["Outcome"].Value = value;	
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_ae178fa5e30f40bf9dd229760a2ba2dd K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_ae178fa5e30f40bf9dd229760a2ba2dd K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>ae178fa5e30f40bf9dd229760a2ba2dd</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bbb4bf4b5de34df5be42395f8d82d92a</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="b68017a5-b015-4755-b16f-ad42b235c89d&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>c1dc21cf268343d4b84b6f72d1a2ef3d</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>0ff97ded90b441a884436934bc67a78e</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>721dfc043ae949e7b64cdb28863e30ae</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>4c3c8c2dfb6448a68c4c1313c355cf50</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>1f8101c022864877848efbbf6f44dee1</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ad8ff7733fd74909af4fc9faa1aed4b5</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>184c0950d9d9461da6ed9f79a6a0484e</Guid></Count><Guid>ffbb9605eac24431aacd806cdbc4871d</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>bf1314ff071d4b3c984e479d72f9c565</Guid></ExpressionLevelPair></Expressions><Guid>619ac3c5cb8941ebb6759f41388454c3</Guid></Rule><Guid>014765491c7f43eab303ee32860d238d</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>ef2dff329e4343958d5cb6a22102d069</Guid><MetaData /><Parent ref="ba7c0334-6c7d-4419-ba00-9b2c31cd0435&#xD;" /></DefaultOutcomeSucceedingRule><ClientEventItem Type="SourceCode.Workflow.Design.ClientEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>bc254ae4dab949348bc1c7b79e33a3ca</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventItem_12d6358df0a749c89b1938edd8db7257" x:Name="EventItem_12d6358df0a749c89b1938edd8db7257" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToInternet</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToMobile</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToExchange</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="ClientEventActivity">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="SendToInternet" ExecuteCode="SendWorkToInternet">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToInternet" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToMobile" ExecuteCode="SendWorkToMobile">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToMobile" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToExchange" ExecuteCode="SendWorkToExchange">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToExchange" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>

</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>5879f7e73d3c434cba8201535dc1754f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_12d6358df0a749c89b1938edd8db7257;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventItem_12d6358df0a749c89b1938edd8db7257 : IWorkflowContext<hostContext>
    {

		private bool internetExecuted = false;
        private bool mobileExecuted = false;
        private bool exchangeExecuted = false;
		private bool AllowAnyUserToFinishEventDone = false;

        #region K2 Context

        private hostContext _k2;

        #endregion

		#region Client Event Activity

		 private void UntilCondition(object sender, ConditionalEventArgs e)
        {
			if (!AllowAnyUserToFinishEventDone)
            {
                if (Convert.ToBoolean(K2.Configuration.AllowAnyUserToFinishEvent))
                {
                    K2.VerifyCredentials = false;
                }
                else
                {
                    K2.VerifyCredentials = true;
                }
                AllowAnyUserToFinishEventDone = true;

                K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
                k2context.BeforeAction(K2.Configuration.InternetUrl);
            }
            if (internetExecuted && mobileExecuted && exchangeExecuted)
            {
                e.Result = true;
            }
            else
            {
                e.Result = false;
            }
        }
		#endregion

        #region Internet

		private void ShouldSendToInternet(object sender, ConditionalEventArgs e)
        {
            internetExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToInternet);
        }

        private void SendWorkToInternet(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.InternetUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.InternetPlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
            
        }
        #endregion

        #region Mobile
        private void SendWorkToMobile(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.MobileUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.MobilePlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
        }

        private void ShouldSendToMobile(object sender, ConditionalEventArgs e)
        {
            mobileExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToMobile);
        }
        #endregion

        #region Exchange

        private void ShouldSendToExchange(object sender, ConditionalEventArgs e)
        {
            exchangeExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToExchange);
        }

        private void SendWorkToExchange(object sender, EventArgs e)
        {
            K2.AddWorklist("EXCHANGEPROFILENAME", K2.Configuration.ExchangeProfileName);
            K2.AddWorklist("EXCHANGEFORMTYPE", K2.Configuration.ExchangeFormType);
            
        }

        #endregion


        #region Other Methods

        #endregion


        #region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_12d6358df0a749c89b1938edd8db7257 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>12d6358df0a749c89b1938edd8db7257</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><NotificationMessage Type="SourceCode.Workflow.Authoring.NotificationMessage" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>521ee72810414e8098b750c7a2cc7a14</Guid></NotificationMessage><InternetUrl Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6e31e7dd54934492aa7aeedf4ff72872</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="27d9d8b1-5698-4220-a8bf-7f147e42ade9&#xD;" /><DataFieldName>ActionURL</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0a0f15c8499744e08394788517957507</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[?]]></Value></ValueTypePart><SerialNoFieldPart Type="SourceCode.Workflow.Design.SerialNoFieldPart" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1544598a18814b38882f6248d9252a60</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value>SN={SERIALNO}</Value></SerialNoFieldPart></Parts><Guid>f5a5f9e3c1aa4ccbb5442905526ce5d9</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></InternetUrl><Guid>62c64243f6884228b61cc679d4185bdb</Guid><MetaData /><Parent ref="9a1cc623-0a71-4150-8bfc-9af0d225f6c9&#xD;" /><SendToInternet>1</SendToInternet><InternetPlatform>ASP</InternetPlatform><MobilePlatform>ASP</MobilePlatform></ClientEventItem><DefaultOutcomeEventSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeEventSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>03339977eba84abdb68d223b26ea2fd1</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRule_96db6c3432914847bd9b68bb2acb247b" x:Name="EventSucceedingRule_96db6c3432914847bd9b68bb2acb247b" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ns0:WorkflowContext.LockedActivities>
    <x:Array Type="{x:Type System.String}">
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
    </x:Array>
  </ns0:WorkflowContext.LockedActivities>
  <IfElseActivity x:Name="RuleOutcome">
    <IfElseBranchActivity x:Name="RuleOutcomeTrue">
      <IfElseBranchActivity.Condition>
        <CodeCondition Condition="EvaluateRule" />
      </IfElseBranchActivity.Condition>
      <CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
    </IfElseBranchActivity>
    <IfElseBranchActivity x:Name="RuleOutcomeFalse">
      <CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
    </IfElseBranchActivity>
  </IfElseActivity>

</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>3ec84a80b221416c9dc5f961e6c60b58</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_96db6c3432914847bd9b68bb2acb247b;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_96db6c3432914847bd9b68bb2acb247b : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_96db6c3432914847bd9b68bb2acb247b K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                    e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
                }
                else
                {
                    e.Result = true;
                }
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>8e138c8df4d94b0d8ac1754dbd84d8ba</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_96db6c3432914847bd9b68bb2acb247b
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_96db6c3432914847bd9b68bb2acb247b K2)
			{
                bool retval = false;
                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Started");
            			for (int i = 0; i < K2.Configuration.SetCount; i++)
            			{
                			if (GetRuleResult(K2, i))
                			{
                                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Event Evaluation Result: " + GetName(K2,i));
                  				retval = true;
				                break;
                			} 

            			}
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Completed");
                } 
                else 
                {
                    retval = true;
                }
				return retval;
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_96db6c3432914847bd9b68bb2acb247b K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_96db6c3432914847bd9b68bb2acb247b K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>96db6c3432914847bd9b68bb2acb247b</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>53592d4e5fdd4a08969fe53ae3379833</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="b68017a5-b015-4755-b16f-ad42b235c89d&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>94b75a2cc6ce45e297958c1bfc087b1a</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>f6227ec771b642e582d2827fbde70921</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d6646aa041ab4511b72eec7ca3fa3d4c</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>aebe87a415d34046a7feafcd435d9164</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>2f956775e11743348517f1ab14acce5d</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c2c3dac254184cb68216c839a3d3ee72</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>84f005f31a6747e4aa78f53054420116</Guid></Count><Guid>912d24f674c541e289884c09904b324e</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>6d526035021e457bb2a86c5be6dfe599</Guid></ExpressionLevelPair></Expressions><Guid>77bd6e51b91843d29a311960f6933c7c</Guid></Rule><Guid>6ae0361e179c4b52abdb7c89cf58e174</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>c8c536a579d0453aaa83540bc139a78c</Guid><MetaData /><Parent ref="9a1cc623-0a71-4150-8bfc-9af0d225f6c9&#xD;" /></DefaultOutcomeEventSucceedingRule><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>40c8ae6c9a1f47d5a163fd8066935679</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_bf380e47d7594e0384e0529593412897" x:Name="ActionItem_bf380e47d7594e0384e0529593412897" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>19a15d4c4bde4bab88091e3fbc3b4237</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_bf380e47d7594e0384e0529593412897;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_bf380e47d7594e0384e0529593412897 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_bf380e47d7594e0384e0529593412897 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>a645d455da5e498f9faae8a77da60d59</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_bf380e47d7594e0384e0529593412897
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_bf380e47d7594e0384e0529593412897 K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_bf380e47d7594e0384e0529593412897 K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>bf380e47d7594e0384e0529593412897</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>0d8c454bdfd64b80958e989ecba8563d</Guid><MetaData /><Parent ref="41259bed-67f6-46eb-9a9b-e16f0fc7559e&#xD;" /></DefaultOutcomeAction><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>02f680d80fb045fe8baffb0c985a1c29</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_5e0ae8b176e1447ea29b26b0a09888cc" x:Name="ActionItem_5e0ae8b176e1447ea29b26b0a09888cc" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>a5c1baa3b24245c4a2db1bd705e304ef</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_5e0ae8b176e1447ea29b26b0a09888cc;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_5e0ae8b176e1447ea29b26b0a09888cc : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_5e0ae8b176e1447ea29b26b0a09888cc K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
            
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>fadee6426f9a41f8bbc8dcd459dab1a5</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_5e0ae8b176e1447ea29b26b0a09888cc
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_5e0ae8b176e1447ea29b26b0a09888cc K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_5e0ae8b176e1447ea29b26b0a09888cc K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>5e0ae8b176e1447ea29b26b0a09888cc</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>e885b76ce58d43d79bc89140b4701500</Guid><MetaData /><Parent ref="d846e6ea-586b-4907-b533-6b0d82358277&#xD;" /></DefaultOutcomeAction><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>6b5314b9c390456ab6babe7df83c8216</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_c3acf47618c6444fabe3cca86b1b996c" x:Name="PrecedingRule_c3acf47618c6444fabe3cca86b1b996c" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>3ee8ae8436894a80be1913d339d47883</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_c3acf47618c6444fabe3cca86b1b996c;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_c3acf47618c6444fabe3cca86b1b996c : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_c3acf47618c6444fabe3cca86b1b996c K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>c3acf47618c6444fabe3cca86b1b996c</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>33456a1efbe14d378f64233a5ce5e88b</Guid><MetaData /><Parent ref="4607d319-99e9-4211-ae48-a66248cfe1dd&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>21b76571d76748a5a0c2666f4a5f9dcc</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_63e77800eb3949e0adca4867cb3cc31d" x:Name="StartRule_63e77800eb3949e0adca4867cb3cc31d" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>b4539a11833d40a892e57de7d6f30986</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_63e77800eb3949e0adca4867cb3cc31d;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_63e77800eb3949e0adca4867cb3cc31d : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_63e77800eb3949e0adca4867cb3cc31d K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>63e77800eb3949e0adca4867cb3cc31d</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>484faf8df6bf4cfca7cb3c64bd147618</Guid><MetaData /><Parent ref="4607d319-99e9-4211-ae48-a66248cfe1dd&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>e37bb31131644f8682f800caa65cecee</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_b16f16c3a5db43b4b48314a3a95fe09d" x:Name="DestinationRule_b16f16c3a5db43b4b48314a3a95fe09d" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>50c170bac28e4d6a8eef018353d80c42</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_b16f16c3a5db43b4b48314a3a95fe09d;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_b16f16c3a5db43b4b48314a3a95fe09d : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_b16f16c3a5db43b4b48314a3a95fe09d K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>b16f16c3a5db43b4b48314a3a95fe09d</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>8dd1f7ccf9b444b49759931cf98c3b7a</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>35a33a5170214d7aaaa9a7587d0acd13</Guid><MetaData /><Parent ref="4607d319-99e9-4211-ae48-a66248cfe1dd&#xD;" /></SimpleDestinationRule><SimpleSucceedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>9287e0c1ef6a47899ff1e69eb15d5ef5</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_2b6545910fcb433dba7bc086648b7874" x:Name="SucceedingRule_2b6545910fcb433dba7bc086648b7874" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>744472d0383a45e687f9b41ca5e031c0</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2b6545910fcb433dba7bc086648b7874;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_2b6545910fcb433dba7bc086648b7874 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_2b6545910fcb433dba7bc086648b7874 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.SucceedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>2b6545910fcb433dba7bc086648b7874</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b304095d7cf5437f91163d401329d41a</Guid></Rule><Guid>a3beed01255f4559a3c297a7831b1483</Guid><MetaData /><Parent ref="4607d319-99e9-4211-ae48-a66248cfe1dd&#xD;" /></SimpleSucceedingRule><ServerEventItem Type="SourceCode.Workflow.Design.ServerEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.CodeExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>3f557f8af4ee47d69452c2966564bbc7</Guid><OriginalFileName>@safeitemname@.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_57c896c4040f4d70a0afdbfd2e7c67dc;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
    public partial class EventItem_57c896c4040f4d70a0afdbfd2e7c67dc : ICodeExtender<hostContext>
	{
        public void Main(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_57c896c4040f4d70a0afdbfd2e7c67dc K2)
        {
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteProcess();
        }
    }
} 
]]></Content></CodeFile></CodeFiles><Guid>57c896c4040f4d70a0afdbfd2e7c67dc</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><ContextMode>CustomContext</ContextMode><Language>CSharp</Language></Extender><Guid>c33484324a92496d97ae6af9fcacaad4</Guid><MetaData /><Parent ref="d476475a-68ca-4786-8ea7-660dfba7e1d7&#xD;" /></ServerEventItem><SimpleLineRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>1876835fa9634cea809186fa17246fff</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.LineRule_6113ff8c419d428aaf1976ed9d009fa1" x:Name="LineRule_6113ff8c419d428aaf1976ed9d009fa1" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>f9bc1d2e5a454450b4927ad7b2e9051b</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_6113ff8c419d428aaf1976ed9d009fa1;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class LineRule_6113ff8c419d428aaf1976ed9d009fa1 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_6113ff8c419d428aaf1976ed9d009fa1 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.LineRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>6113ff8c419d428aaf1976ed9d009fa1</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>4901164fcc6e430aaefd90ece08e9ff9</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="542d761a-3a80-430d-b0a3-bc21bde1d7b7&#xD;" /><DataFieldName>Outcome</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart></Parts><Guid>5bde310f91c34159a19d6524ac6c626e</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>ed1c703cf6804b43983721c3bd9d179b</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c3c9a81068c346ef882d5473067ec912</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>409f5b2c1972432e8b5ce897739436fd</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>be1652bde2624373b2d78a1e1a35de90</Guid></Right><Guid>bfa84ef9560b486581e9c16b250d2c7b</Guid><Operator>Equal</Operator></Exp><Guid>c1d13814b5814be587e92ecfada7c210</Guid></ExpressionLevelPair></Expressions><Guid>71adfe6e12c5438b89b069ae387d2944</Guid></Rule><Guid>63bdbfdd2f904110b06a04701c2eace3</Guid><MetaData /><Parent ref="91335fd8-cab2-49a0-9426-d2efe1cf51cb&#xD;" /></SimpleLineRule><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>01ec360df9ce4aba9dca6b4b35b81429</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_1dc482379f344c979fc51a5f4347fd4b" x:Name="PrecedingRule_1dc482379f344c979fc51a5f4347fd4b" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>620168e719924479a98dc5ae0790cbab</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_1dc482379f344c979fc51a5f4347fd4b;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_1dc482379f344c979fc51a5f4347fd4b : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_1dc482379f344c979fc51a5f4347fd4b K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>1dc482379f344c979fc51a5f4347fd4b</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>bb9c1c28c3d94d5983e6b6491d814dde</Guid><MetaData /><Parent ref="1cea4bea-345b-4cc0-98d0-441da2427b85&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>0675ef6a597d46d4a02cf0686b019c9c</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_99d2427f20ab4f7eb8c87d204ba27665" x:Name="StartRule_99d2427f20ab4f7eb8c87d204ba27665" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>9913228b46b34473882e111ad9509a94</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_99d2427f20ab4f7eb8c87d204ba27665;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_99d2427f20ab4f7eb8c87d204ba27665 : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_99d2427f20ab4f7eb8c87d204ba27665 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>99d2427f20ab4f7eb8c87d204ba27665</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>5eb73723a1a24a728924f58e52ab8a68</Guid><MetaData /><Parent ref="1cea4bea-345b-4cc0-98d0-441da2427b85&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>12a5853bc9084cbcb38134a0c6b26995</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_52aacac0f4634c76ba942f8148778b3b" x:Name="DestinationRule_52aacac0f4634c76ba942f8148778b3b" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>2d2a1f84f7614e458e77f9ea0d115d0a</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_52aacac0f4634c76ba942f8148778b3b;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_52aacac0f4634c76ba942f8148778b3b : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_52aacac0f4634c76ba942f8148778b3b K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
            
            K2.ResolveQueuesToUsers = false;

            string dests = K2.ProcessInstance.DataFields["dest_allowancer"].Value.ToString();
            K2Context k2content = new K2Context(K2.Destinations, K2.ActivityInstance);
            k2content.InitDestination(dests);
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>52aacac0f4634c76ba942f8148778b3b</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Destinations><Destination Type="SourceCode.Workflow.Design.SimpleRules.Destination" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c2db96c9a3b641c5a0d9bc02424c1c43</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[-1]]></Value></ValueTypePart></Parts><Guid>a92d218bbe1445708fb57f21727142d4</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>08a785707069421d9e2212bcf10288ab</Guid><DestinationType>Group</DestinationType></Destination></Destinations><Guid>0606d9f334b14d7793d872ed8276180f</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>4e733b8e9fbb43ca8e487b4e1f67784a</Guid><MetaData /><Parent ref="1cea4bea-345b-4cc0-98d0-441da2427b85&#xD;" /></SimpleDestinationRule><DefaultOutcomeSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>05a0977f6aab4ab9bbf3a948008688a8</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_8e8fc9e03a3c459482c10cd1bdbad57a" x:Name="SucceedingRule_8e8fc9e03a3c459482c10cd1bdbad57a" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<IfElseActivity x:Name="RuleOutcome">
		<IfElseBranchActivity x:Name="RuleOutcomeTrue">
			<IfElseBranchActivity.Condition>
				<CodeCondition Condition="EvaluateRule" />
			</IfElseBranchActivity.Condition>
			<CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
		</IfElseBranchActivity>
		<IfElseBranchActivity x:Name="RuleOutcomeFalse">
			<CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
		</IfElseBranchActivity>
	</IfElseActivity>
	
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>88b73ee936f34abd80948e989e08c75f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_8e8fc9e03a3c459482c10cd1bdbad57a;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_8e8fc9e03a3c459482c10cd1bdbad57a : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_8e8fc9e03a3c459482c10cd1bdbad57a K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

            		e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>9584e1ac6c6a4ad49ed83dd6a05f01f6</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_8e8fc9e03a3c459482c10cd1bdbad57a
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_8e8fc9e03a3c459482c10cd1bdbad57a K2)
			{
				bool retval = false;
                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Started");
    			for (int i = 0; i < K2.Configuration.SetCount; i++)
    			{
        			if (GetRuleResult(K2, i))
        			{
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Event Evaluation Result: " + GetName(K2,i));
            			SetOutcomeResult(K2, GetName(K2,i));
          				retval = true;
		                break;
        			} 

    			}

                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Completed");
				return retval;
			}

			public static void SetOutcomeResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_8e8fc9e03a3c459482c10cd1bdbad57a K2, string value)
			{
				K2.ActivityInstance.DataFields["Outcome"].Value = value;	
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_8e8fc9e03a3c459482c10cd1bdbad57a K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_8e8fc9e03a3c459482c10cd1bdbad57a K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>8e8fc9e03a3c459482c10cd1bdbad57a</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>8d019dadd17c417793178747eb462360</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="3d4f694e-22d8-473c-89d2-70d53ee5a437&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>2c75051f5b67483a9fe3c2319158acf1</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>00f1096ceadd4b40b64b9b185600326f</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3def9440d3ab4b6ea330202ef14c161f</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>fc3d6c00a4fd46f1a6fd195a77784fc7</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>c1a1ff89856b4b26884fe0f8ba41271c</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c31d35e5945f42b29e49ac154ef8b389</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>24f19f9d67684d348643e76fa871904d</Guid></Count><Guid>81998d9f5b1a4a23abc9d43a5cc080e7</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>16d2f0ebc6724e598375005ca1208abc</Guid></ExpressionLevelPair></Expressions><Guid>63cfdd68690345fd84ced0699d562018</Guid></Rule><Guid>b0f527775ead4cfabda4adc16779b354</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>bf3758d424f2442face372c9d3390c41</Guid><MetaData /><Parent ref="1cea4bea-345b-4cc0-98d0-441da2427b85&#xD;" /></DefaultOutcomeSucceedingRule><ClientEventItem Type="SourceCode.Workflow.Design.ClientEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>4bbaa68365f544f9a397b775e395d6f1</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventItem_7d464b5b986c4efa9f04c7c6e7fc8093" x:Name="EventItem_7d464b5b986c4efa9f04c7c6e7fc8093" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToInternet</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToMobile</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToExchange</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="ClientEventActivity">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="SendToInternet" ExecuteCode="SendWorkToInternet">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToInternet" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToMobile" ExecuteCode="SendWorkToMobile">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToMobile" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToExchange" ExecuteCode="SendWorkToExchange">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToExchange" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>

</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>0cf7f6573fd847c496e867ec99e7c535</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_7d464b5b986c4efa9f04c7c6e7fc8093;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventItem_7d464b5b986c4efa9f04c7c6e7fc8093 : IWorkflowContext<hostContext>
    {

		private bool internetExecuted = false;
        private bool mobileExecuted = false;
        private bool exchangeExecuted = false;
		private bool AllowAnyUserToFinishEventDone = false;

        #region K2 Context

        private hostContext _k2;

        #endregion

		#region Client Event Activity

		 private void UntilCondition(object sender, ConditionalEventArgs e)
        {
			if (!AllowAnyUserToFinishEventDone)
            {
                if (Convert.ToBoolean(K2.Configuration.AllowAnyUserToFinishEvent))
                {
                    K2.VerifyCredentials = false;
                }
                else
                {
                    K2.VerifyCredentials = true;
                }
                AllowAnyUserToFinishEventDone = true;

                K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
                k2context.BeforeAction(K2.Configuration.InternetUrl);
            }
            if (internetExecuted && mobileExecuted && exchangeExecuted)
            {
                e.Result = true;
            }
            else
            {
                e.Result = false;
            }
        }
		#endregion

        #region Internet

		private void ShouldSendToInternet(object sender, ConditionalEventArgs e)
        {
            internetExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToInternet);
        }

        private void SendWorkToInternet(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.InternetUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.InternetPlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
            
        }
        #endregion

        #region Mobile
        private void SendWorkToMobile(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.MobileUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.MobilePlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
        }

        private void ShouldSendToMobile(object sender, ConditionalEventArgs e)
        {
            mobileExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToMobile);
        }
        #endregion

        #region Exchange

        private void ShouldSendToExchange(object sender, ConditionalEventArgs e)
        {
            exchangeExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToExchange);
        }

        private void SendWorkToExchange(object sender, EventArgs e)
        {
            K2.AddWorklist("EXCHANGEPROFILENAME", K2.Configuration.ExchangeProfileName);
            K2.AddWorklist("EXCHANGEFORMTYPE", K2.Configuration.ExchangeFormType);
            
        }

        #endregion


        #region Other Methods

        #endregion


        #region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_7d464b5b986c4efa9f04c7c6e7fc8093 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>7d464b5b986c4efa9f04c7c6e7fc8093</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><NotificationMessage Type="SourceCode.Workflow.Authoring.NotificationMessage" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>814c1c02cc1545508b208302fe10102e</Guid></NotificationMessage><InternetUrl Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>51193d92116d4d27a231fa99f6832982</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="0700f44b-1a53-454c-912e-b169c5860dc8&#xD;" /><DataFieldName>ActionURL</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>df7ed6bf6e7d47fca86d72aceccef271</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[?]]></Value></ValueTypePart><SerialNoFieldPart Type="SourceCode.Workflow.Design.SerialNoFieldPart" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>95045e89208f41919f7acf527dedb330</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value>SN={SERIALNO}</Value></SerialNoFieldPart></Parts><Guid>358b1012a9324ad4944e12aa3711f906</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></InternetUrl><Guid>cea9b448c4754294a438dd8afd43d0ca</Guid><MetaData /><Parent ref="44c1278e-212c-4f83-be86-1b3ea0eea6ae&#xD;" /><SendToInternet>1</SendToInternet><InternetPlatform>ASP</InternetPlatform><MobilePlatform>ASP</MobilePlatform></ClientEventItem><DefaultOutcomeEventSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeEventSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>4f5ea6348a854ba9b825f2fda173832a</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRule_1b7f42e61d5a444c98cef9c77ba24444" x:Name="EventSucceedingRule_1b7f42e61d5a444c98cef9c77ba24444" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ns0:WorkflowContext.LockedActivities>
    <x:Array Type="{x:Type System.String}">
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
    </x:Array>
  </ns0:WorkflowContext.LockedActivities>
  <IfElseActivity x:Name="RuleOutcome">
    <IfElseBranchActivity x:Name="RuleOutcomeTrue">
      <IfElseBranchActivity.Condition>
        <CodeCondition Condition="EvaluateRule" />
      </IfElseBranchActivity.Condition>
      <CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
    </IfElseBranchActivity>
    <IfElseBranchActivity x:Name="RuleOutcomeFalse">
      <CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
    </IfElseBranchActivity>
  </IfElseActivity>

</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>ba708f11502e456cb8c994912c179d09</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_1b7f42e61d5a444c98cef9c77ba24444;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_1b7f42e61d5a444c98cef9c77ba24444 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_1b7f42e61d5a444c98cef9c77ba24444 K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                    e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
                }
                else
                {
                    e.Result = true;
                }
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>220a4128b104424a93bb84becb8f9ed6</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_1b7f42e61d5a444c98cef9c77ba24444
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_1b7f42e61d5a444c98cef9c77ba24444 K2)
			{
                bool retval = false;
                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Started");
            			for (int i = 0; i < K2.Configuration.SetCount; i++)
            			{
                			if (GetRuleResult(K2, i))
                			{
                                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Event Evaluation Result: " + GetName(K2,i));
                  				retval = true;
				                break;
                			} 

            			}
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Completed");
                } 
                else 
                {
                    retval = true;
                }
				return retval;
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_1b7f42e61d5a444c98cef9c77ba24444 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_1b7f42e61d5a444c98cef9c77ba24444 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>1b7f42e61d5a444c98cef9c77ba24444</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d33480f1eae84419be3c509fd1168231</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="3d4f694e-22d8-473c-89d2-70d53ee5a437&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>8eb5ba3b5e834e64a1d1f9039d484097</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>854767602dd749d08b32bec59fef11ad</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>937e3d812ce3479ebb21ce856022c741</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>c3194bcc52874ba5a7c8c89f42031555</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>d35a10a996ca4e5cbd541f916655f4ba</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bb72a1cd2399407a99c66db33f1cf1aa</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>7035970fcc7045c891880db60a6a3328</Guid></Count><Guid>4f738bc5dd424ee681d57f53ac570cca</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>801bb502b17e4444aeaacb1393191778</Guid></ExpressionLevelPair></Expressions><Guid>b9cffd071ae142369941129ef2cb2ea5</Guid></Rule><Guid>6edb77c12c2d4533b602c720f51288ef</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>16a5ca2641364153b578955a6da26a0b</Guid><MetaData /><Parent ref="44c1278e-212c-4f83-be86-1b3ea0eea6ae&#xD;" /></DefaultOutcomeEventSucceedingRule><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>83aa3a56c1f8465396c7e141ef1276e8</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_e97e80f9da83478ab2a443d146741a7c" x:Name="ActionItem_e97e80f9da83478ab2a443d146741a7c" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>17926d1503f5423f96ef60df5a99df6f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_e97e80f9da83478ab2a443d146741a7c;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_e97e80f9da83478ab2a443d146741a7c : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_e97e80f9da83478ab2a443d146741a7c K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>13ba131ac45e47c7ae17c24033848d5e</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_e97e80f9da83478ab2a443d146741a7c
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_e97e80f9da83478ab2a443d146741a7c K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_e97e80f9da83478ab2a443d146741a7c K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>e97e80f9da83478ab2a443d146741a7c</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>51086f6b1c9d49ad98140bcc44a326f7</Guid><MetaData /><Parent ref="cd05b7c7-9399-4069-89be-4957b09833fa&#xD;" /></DefaultOutcomeAction><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>937447aeac8440a5a2cd03e97ca65b27</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_a2673a6f73544225a0613876ec4d2350" x:Name="ActionItem_a2673a6f73544225a0613876ec4d2350" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>d82b31a9f300453e9a6d7ae857874d7c</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_a2673a6f73544225a0613876ec4d2350;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_a2673a6f73544225a0613876ec4d2350 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_a2673a6f73544225a0613876ec4d2350 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
            
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>424acecbe54b4a86b050f62b19b1df48</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_a2673a6f73544225a0613876ec4d2350
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_a2673a6f73544225a0613876ec4d2350 K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_a2673a6f73544225a0613876ec4d2350 K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>a2673a6f73544225a0613876ec4d2350</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>b4b31924df0e42bdad07c0fbbe27963a</Guid><MetaData /><Parent ref="52ec2691-8f21-4284-8fe9-c8b0aa940b95&#xD;" /></DefaultOutcomeAction><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>a65b127c125a487bbf03c14524ff3938</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_8887bc92a9fd4f1fb837c5297078439d" x:Name="PrecedingRule_8887bc92a9fd4f1fb837c5297078439d" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>500c238b6d124de5bb4d07413b853dea</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_8887bc92a9fd4f1fb837c5297078439d;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_8887bc92a9fd4f1fb837c5297078439d : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_8887bc92a9fd4f1fb837c5297078439d K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>8887bc92a9fd4f1fb837c5297078439d</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>9367e97c26f34abca61fd7bed6e6e9b8</Guid><MetaData /><Parent ref="6a5dbb70-7863-4e90-8fa3-d2189c04c3ab&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>391a73e2208b4d9aa62b058951f19198</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_b2c9a932021a48a39c60b7f17eab3dd7" x:Name="StartRule_b2c9a932021a48a39c60b7f17eab3dd7" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>f419dd25cc8944f29565c268613c238d</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_b2c9a932021a48a39c60b7f17eab3dd7;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_b2c9a932021a48a39c60b7f17eab3dd7 : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_b2c9a932021a48a39c60b7f17eab3dd7 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>b2c9a932021a48a39c60b7f17eab3dd7</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>90ea7db1954b4ac49180f221660e9a99</Guid><MetaData /><Parent ref="6a5dbb70-7863-4e90-8fa3-d2189c04c3ab&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>058f8476f905404bb19121fb283690b7</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_d31aafdfbac94ab09e44c33173f4afc0" x:Name="DestinationRule_d31aafdfbac94ab09e44c33173f4afc0" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>51090c20cc2f4324a368bc98e857d483</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_d31aafdfbac94ab09e44c33173f4afc0;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_d31aafdfbac94ab09e44c33173f4afc0 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_d31aafdfbac94ab09e44c33173f4afc0 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
            
            K2.ResolveQueuesToUsers = false;

            string dests = K2.ProcessInstance.DataFields["dest_allowancemanagerlevel1"].Value.ToString();
            K2Context k2content = new K2Context(K2.Destinations, K2.ActivityInstance);
            k2content.InitDestination(dests);
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>d31aafdfbac94ab09e44c33173f4afc0</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Destinations><Destination Type="SourceCode.Workflow.Design.SimpleRules.Destination" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5318cc67e31c4837bd1b37084d3f9345</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[-1]]></Value></ValueTypePart></Parts><Guid>543d83bf6edf470db6f4ac60a5ce0b1d</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>4aa3198cc3044cc4b5f22f6ed75f5eea</Guid><DestinationType>Group</DestinationType></Destination></Destinations><Guid>148189a7ed07432db4a149504de4d9f2</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>a07a3365082d4398a8e3080ce8584e75</Guid><MetaData /><Parent ref="6a5dbb70-7863-4e90-8fa3-d2189c04c3ab&#xD;" /></SimpleDestinationRule><DefaultOutcomeSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>9af032570d414887b10b36aab1c68be2</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_09e5bb42de954ff3832de57c72532059" x:Name="SucceedingRule_09e5bb42de954ff3832de57c72532059" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<IfElseActivity x:Name="RuleOutcome">
		<IfElseBranchActivity x:Name="RuleOutcomeTrue">
			<IfElseBranchActivity.Condition>
				<CodeCondition Condition="EvaluateRule" />
			</IfElseBranchActivity.Condition>
			<CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
		</IfElseBranchActivity>
		<IfElseBranchActivity x:Name="RuleOutcomeFalse">
			<CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
		</IfElseBranchActivity>
	</IfElseActivity>
	
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>eae7f6478fa642fab3838586bec5cfa5</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_09e5bb42de954ff3832de57c72532059;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_09e5bb42de954ff3832de57c72532059 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_09e5bb42de954ff3832de57c72532059 K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

            		e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>ec9e7497297445daa9e7fb167c639616</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_09e5bb42de954ff3832de57c72532059
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_09e5bb42de954ff3832de57c72532059 K2)
			{
				bool retval = false;
                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Started");
    			for (int i = 0; i < K2.Configuration.SetCount; i++)
    			{
        			if (GetRuleResult(K2, i))
        			{
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Event Evaluation Result: " + GetName(K2,i));
            			SetOutcomeResult(K2, GetName(K2,i));
          				retval = true;
		                break;
        			} 

    			}

                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Completed");
				return retval;
			}

			public static void SetOutcomeResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_09e5bb42de954ff3832de57c72532059 K2, string value)
			{
				K2.ActivityInstance.DataFields["Outcome"].Value = value;	
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_09e5bb42de954ff3832de57c72532059 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_09e5bb42de954ff3832de57c72532059 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>09e5bb42de954ff3832de57c72532059</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>62b3b385274a4a47b580f5df25a9a151</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="dc83ad39-c156-4b87-ab5f-353b0be078d4&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>8572eb70615d4383a60366c2b5152279</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>e3a83954c1e8472faee622b61bd69b0e</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2466ab535f494dc98c10de0df34cdf52</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>243cb295932044adb7ce4099951a4097</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>809e31f25bd2403ea32e48d58808d3ae</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>912e80a6142240d29f1870ab5592cc8e</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>a203e50040ff4d4e90a22c9dfd26c42f</Guid></Count><Guid>b759668228bd4244828a2bda53e91e2a</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>e3f1afd2f06045cebaa14d5398d9bce8</Guid></ExpressionLevelPair></Expressions><Guid>63ff6347d5cb4a57b7e6b7321abe405d</Guid></Rule><Guid>9726962714214fb0b92a16d3927aa902</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>4c027f2db26c4a46bf2014e817c5f7cb</Guid><MetaData /><Parent ref="6a5dbb70-7863-4e90-8fa3-d2189c04c3ab&#xD;" /></DefaultOutcomeSucceedingRule><ClientEventItem Type="SourceCode.Workflow.Design.ClientEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>fd09616c8f01415fb47aa1e6a64673e0</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventItem_81c8570839264380bca77364f7341049" x:Name="EventItem_81c8570839264380bca77364f7341049" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToInternet</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToMobile</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToExchange</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="ClientEventActivity">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="SendToInternet" ExecuteCode="SendWorkToInternet">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToInternet" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToMobile" ExecuteCode="SendWorkToMobile">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToMobile" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToExchange" ExecuteCode="SendWorkToExchange">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToExchange" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>

</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>38160e0949224432bf90f7ccd6c1fad2</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_81c8570839264380bca77364f7341049;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventItem_81c8570839264380bca77364f7341049 : IWorkflowContext<hostContext>
    {

		private bool internetExecuted = false;
        private bool mobileExecuted = false;
        private bool exchangeExecuted = false;
		private bool AllowAnyUserToFinishEventDone = false;

        #region K2 Context

        private hostContext _k2;

        #endregion

		#region Client Event Activity

		 private void UntilCondition(object sender, ConditionalEventArgs e)
        {
			if (!AllowAnyUserToFinishEventDone)
            {
                if (Convert.ToBoolean(K2.Configuration.AllowAnyUserToFinishEvent))
                {
                    K2.VerifyCredentials = false;
                }
                else
                {
                    K2.VerifyCredentials = true;
                }
                AllowAnyUserToFinishEventDone = true;

                K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
                k2context.BeforeAction(K2.Configuration.InternetUrl);
            }
            if (internetExecuted && mobileExecuted && exchangeExecuted)
            {
                e.Result = true;
            }
            else
            {
                e.Result = false;
            }
        }
		#endregion

        #region Internet

		private void ShouldSendToInternet(object sender, ConditionalEventArgs e)
        {
            internetExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToInternet);
        }

        private void SendWorkToInternet(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.InternetUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.InternetPlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
            
        }
        #endregion

        #region Mobile
        private void SendWorkToMobile(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.MobileUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.MobilePlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
        }

        private void ShouldSendToMobile(object sender, ConditionalEventArgs e)
        {
            mobileExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToMobile);
        }
        #endregion

        #region Exchange

        private void ShouldSendToExchange(object sender, ConditionalEventArgs e)
        {
            exchangeExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToExchange);
        }

        private void SendWorkToExchange(object sender, EventArgs e)
        {
            K2.AddWorklist("EXCHANGEPROFILENAME", K2.Configuration.ExchangeProfileName);
            K2.AddWorklist("EXCHANGEFORMTYPE", K2.Configuration.ExchangeFormType);
            
        }

        #endregion


        #region Other Methods

        #endregion


        #region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_81c8570839264380bca77364f7341049 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>81c8570839264380bca77364f7341049</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><NotificationMessage Type="SourceCode.Workflow.Authoring.NotificationMessage" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d8df53c66a5640049765c853257b5727</Guid></NotificationMessage><InternetUrl Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ad4fe89f17b14f4f9fd5f342b5af32f6</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="f33d7d62-eb03-42c6-8e3c-41e12898ba6c&#xD;" /><DataFieldName>ActionURL</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>65c2494c599448f69ecb7e5cbb5f5c38</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[?]]></Value></ValueTypePart><SerialNoFieldPart Type="SourceCode.Workflow.Design.SerialNoFieldPart" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>7b2ebe3861a24a3d8e80edbc1b195070</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value>SN={SERIALNO}</Value></SerialNoFieldPart></Parts><Guid>99ba0f8593904f4f8149ae0c193a947d</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></InternetUrl><Guid>ee1273340c9b4f3fac1bb13ce9affba3</Guid><MetaData /><Parent ref="d4d60b83-0e47-47aa-9a00-3efce91af7b1&#xD;" /><SendToInternet>1</SendToInternet><InternetPlatform>ASP</InternetPlatform><MobilePlatform>ASP</MobilePlatform></ClientEventItem><DefaultOutcomeEventSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeEventSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>74b380271722494d9d30b1a24ba53cee</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRule_e33b7991001b45cda60022bb451e38b6" x:Name="EventSucceedingRule_e33b7991001b45cda60022bb451e38b6" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ns0:WorkflowContext.LockedActivities>
    <x:Array Type="{x:Type System.String}">
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
    </x:Array>
  </ns0:WorkflowContext.LockedActivities>
  <IfElseActivity x:Name="RuleOutcome">
    <IfElseBranchActivity x:Name="RuleOutcomeTrue">
      <IfElseBranchActivity.Condition>
        <CodeCondition Condition="EvaluateRule" />
      </IfElseBranchActivity.Condition>
      <CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
    </IfElseBranchActivity>
    <IfElseBranchActivity x:Name="RuleOutcomeFalse">
      <CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
    </IfElseBranchActivity>
  </IfElseActivity>

</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>351a0bf4b670477b929286ea12eefdf7</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_e33b7991001b45cda60022bb451e38b6;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_e33b7991001b45cda60022bb451e38b6 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_e33b7991001b45cda60022bb451e38b6 K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                    e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
                }
                else
                {
                    e.Result = true;
                }
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>26272ed61a3f4a89beffa90a0e207f97</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_e33b7991001b45cda60022bb451e38b6
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_e33b7991001b45cda60022bb451e38b6 K2)
			{
                bool retval = false;
                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Started");
            			for (int i = 0; i < K2.Configuration.SetCount; i++)
            			{
                			if (GetRuleResult(K2, i))
                			{
                                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Event Evaluation Result: " + GetName(K2,i));
                  				retval = true;
				                break;
                			} 

            			}
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Completed");
                } 
                else 
                {
                    retval = true;
                }
				return retval;
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_e33b7991001b45cda60022bb451e38b6 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_e33b7991001b45cda60022bb451e38b6 K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>e33b7991001b45cda60022bb451e38b6</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c043db82b7594795a3f710ad637f7fd2</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="dc83ad39-c156-4b87-ab5f-353b0be078d4&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>2dc87becb5dd44fb818e0bd5a50bfbb2</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>c7b590d1391041a7b59368f206f63e64</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bd842023026844628712f9a84281f670</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>0bdf490d932f4ae38417d31ee372fef7</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>02fe91120bc14188a35923f216e3d872</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ea8e4581377f4d069750cd2bcd66cdfc</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>13f92a6ca26d441ab9451274b8c6e7bc</Guid></Count><Guid>d871a6f2da9a4adfae4de58fcce38846</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>63c792502af34b52974f94328bcd70de</Guid></ExpressionLevelPair></Expressions><Guid>194d1b0c307d4b8e9c09b1c37040a385</Guid></Rule><Guid>9e1675a4135747c9a5e08fd1dbc5123b</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>078000f1797c44679b3e4cfecf9aa4c8</Guid><MetaData /><Parent ref="d4d60b83-0e47-47aa-9a00-3efce91af7b1&#xD;" /></DefaultOutcomeEventSucceedingRule><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>cb0f9d1ddad9490ca7eabfb787d6d8f4</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_15d8baf075f743ec934017c78fd02a27" x:Name="ActionItem_15d8baf075f743ec934017c78fd02a27" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>234a8f26bac84bb0b3391927fdc8dbc1</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_15d8baf075f743ec934017c78fd02a27;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_15d8baf075f743ec934017c78fd02a27 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_15d8baf075f743ec934017c78fd02a27 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>b75a29baec1645098ae75168ab00169a</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_15d8baf075f743ec934017c78fd02a27
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_15d8baf075f743ec934017c78fd02a27 K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_15d8baf075f743ec934017c78fd02a27 K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>15d8baf075f743ec934017c78fd02a27</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>98d7146699984863854394747170be8f</Guid><MetaData /><Parent ref="1750cc06-9566-4dce-b467-89c9fb2e4b1f&#xD;" /></DefaultOutcomeAction><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>084eaeb3745b4a3688620232b37ddfa7</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_b448d31f69de4c2fbf25b5bf8ba3b322" x:Name="ActionItem_b448d31f69de4c2fbf25b5bf8ba3b322" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>8bc91c6f2a604d219c04ca2fc029e160</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_b448d31f69de4c2fbf25b5bf8ba3b322;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_b448d31f69de4c2fbf25b5bf8ba3b322 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_b448d31f69de4c2fbf25b5bf8ba3b322 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
            
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>dcc3ae287c2840fe8852c102e108d0a8</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_b448d31f69de4c2fbf25b5bf8ba3b322
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_b448d31f69de4c2fbf25b5bf8ba3b322 K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_b448d31f69de4c2fbf25b5bf8ba3b322 K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>b448d31f69de4c2fbf25b5bf8ba3b322</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>79034cd51acb4d20ad55391f2651b61b</Guid><MetaData /><Parent ref="ff865f4c-811e-41e5-b70c-d9bcd68cb2e6&#xD;" /></DefaultOutcomeAction><SimpleLineRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>241c3a9f17b54ebeb464dfd63958fbe3</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.LineRule_cd3a9179559145e888f5d1e544c8da2d" x:Name="LineRule_cd3a9179559145e888f5d1e544c8da2d" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>fc954dfdd85940cc97863cd752fa837d</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_cd3a9179559145e888f5d1e544c8da2d;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class LineRule_cd3a9179559145e888f5d1e544c8da2d : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_cd3a9179559145e888f5d1e544c8da2d K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.LineRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>cd3a9179559145e888f5d1e544c8da2d</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c28f70ce2f3848618b70a4adc6ac624b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="dd47cd55-4468-4385-88a0-e56b9843b476&#xD;" /><DataFieldName>Outcome</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart></Parts><Guid>1893ff403d864efda1b7c0463605717d</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>462751f33d214030bad93818e8c01e4f</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>76491bcb1f65430b9373313c0b23067b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>43346ded213b4697bd2eebf8ce677458</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>eef8ed745b7e4b39aea6b0b31fce4458</Guid></Right><Guid>dc833a43f8b74a8d93162d20ad575112</Guid><Operator>Equal</Operator></Exp><Guid>ff894c704fc04c0db71894b8bb0582fb</Guid></ExpressionLevelPair></Expressions><Guid>9913fcecc5024971b47f63e4b3be8ed5</Guid></Rule><Guid>30833d49c76e45aaaa9f800047f4413d</Guid><MetaData /><Parent ref="9fed9f02-ae74-4de7-8d68-b0e6464c25ee&#xD;" /></SimpleLineRule><SimpleLineRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>c19996d84c1a4819b9cab708e13f89ac</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.LineRule_8ac7f0963a0c400da8b89b58b5d7fd47" x:Name="LineRule_8ac7f0963a0c400da8b89b58b5d7fd47" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>7c0548dd02714812acf4a35628d8c757</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_8ac7f0963a0c400da8b89b58b5d7fd47;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class LineRule_8ac7f0963a0c400da8b89b58b5d7fd47 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_8ac7f0963a0c400da8b89b58b5d7fd47 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.LineRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>8ac7f0963a0c400da8b89b58b5d7fd47</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c099cf1f94d44ff69658303769ac100e</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="77373408-659c-41a8-8f90-62214a62a4ec&#xD;" /><DataFieldName>Outcome</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart></Parts><Guid>dea3bb94a36d4ce6b2eb242a9a4f088b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>4a192ce045e046bd871972cbd84af875</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>642daf5d02b8472eaf0f6e0524db6702</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>44b945ceedd04d8ba80db1858fd18fa8</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>485fbbfd56f647f3aed0bfd2afe642cb</Guid></Right><Guid>d2a396b63e1c4238874e7a4bc6927c82</Guid><Operator>Equal</Operator></Exp><Guid>48b7cfde22304494a40ae59eda6e5990</Guid></ExpressionLevelPair></Expressions><Guid>251587f3ad23406fa28cd01a594efdda</Guid></Rule><Guid>a2e1a5addab345b58e95a66b40744bd6</Guid><MetaData /><Parent ref="d7b82295-800a-4ef1-a608-fa63a9808893&#xD;" /></SimpleLineRule><SimplePrecedingRule Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>4019b9725dd648e2a77ef3e2afae32da</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRule_1a3c6d1fee444f46bb4dafa5228d0b25" x:Name="PrecedingRule_1a3c6d1fee444f46bb4dafa5228d0b25" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>568cff034db14b9d8b411d394a2edd39</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_1a3c6d1fee444f46bb4dafa5228d0b25;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class PrecedingRule_1a3c6d1fee444f46bb4dafa5228d0b25 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.PrecedingRuleContext_1a3c6d1fee444f46bb4dafa5228d0b25 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.PrecedingRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>1a3c6d1fee444f46bb4dafa5228d0b25</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>0d409e17c0fb472092950954fe29f3d9</Guid><MetaData /><Parent ref="bd952f2d-0fd7-48dc-9261-ae9deb80abce&#xD;" /></SimplePrecedingRule><SimpleActivityStartRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>36da5f69b38e4e2db0fa48cbe8448a35</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.StartRule_248cd61456e84899a5365b13dd256835" x:Name="StartRule_248cd61456e84899a5365b13dd256835" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type p5:String}" xmlns:p5="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">useDateAndTimeCodeActivity</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">conditionedStartRule</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="conditionedStartRule">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="useDateCodeActivity" ExecuteCode="useDateCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDate" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useTimeCodeActivity" ExecuteCode="useTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="useDateAndTimeCodeActivity" ExecuteCode="useDateAndTimeCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="UseDateAndTime" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="startNowCodeActivity" ExecuteCode="startNowCodeActivity_ExecuteCode">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="StartNow" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>
</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>de8dfc3e03fc4231aa8b6c4c513921f6</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_248cd61456e84899a5365b13dd256835;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class StartRule_248cd61456e84899a5365b13dd256835 : IWorkflowContext<hostContext>
	{

		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.StartRuleContext_248cd61456e84899a5365b13dd256835 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

        #region - Conditions -

        bool _startRuleSet = false;

        private void UseDate(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == false;
        }
        private void UseDateAndTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == true && K2.Configuration.UseTime == true;
        }
        private void UseTime(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == true;
        }

        private void StartNow(object sender, ConditionalEventArgs e)
        {
            e.Result = K2.Configuration.UseDate == false && K2.Configuration.UseTime == false;
        }

        private void UntilCondition(object sender, ConditionalEventArgs e)
        {
            e.Result = _startRuleSet;
        }

        #endregion

        #region - Start Rule Code -

        private void useDateCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date only
            K2.SetStartRule(K2.Configuration.StartDate);
            _startRuleSet = true;
        }

        private void useTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using time only
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void useDateAndTimeCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            // Start using date and time
            if (K2.Configuration.UseDefaultZone)
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds);
            }
            else
            {
                K2.SetStartRule(K2.Configuration.StartDate, K2.Configuration.StartDays, K2.Configuration.StartHours, K2.Configuration.StartMinutes, K2.Configuration.StartSeconds, K2.Configuration.Zone);
            }
            _startRuleSet = true;
        }

        private void startNowCodeActivity_ExecuteCode(object sender, EventArgs e)
        {
            _startRuleSet = true;
        }

        #endregion

	}
}
]]></Content></CodeFile></CodeFiles><Guid>248cd61456e84899a5365b13dd256835</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>62b71f9420a0428b97ce0aa5bdbff63a</Guid><MetaData /><Parent ref="bd952f2d-0fd7-48dc-9261-ae9deb80abce&#xD;" /></SimpleActivityStartRule><SimpleDestinationRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>bddd575a15a84fedaa4c2a16518ff1a6</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRule_b6bdc914b207435d92b0887aa8f60c26" x:Name="DestinationRule_b6bdc914b207435d92b0887aa8f60c26" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="DestinationRule" ExecuteCode="DestinationRule_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>10ecb21213994a2ea066b74e640280b3</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_b6bdc914b207435d92b0887aa8f60c26;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class DestinationRule_b6bdc914b207435d92b0887aa8f60c26 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.DestinationRuleContext_b6bdc914b207435d92b0887aa8f60c26 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        
        private void DestinationRule_ExecuteCode(object sender, EventArgs e)
        {
            if (K2.ActivityInstance.SlotInstance)
            {
                //
                // The activity is a slot instance activity
                //

                int slotCount = 0;
                string[] slotInstanceData = null;

                if (K2.Configuration.DynamicSlots)
                {
                    // If it is dynamic slot, get the slot count from
                    // the initialization data
                    slotCount = K2.Configuration.SlotInstanceData.Length;
                    slotInstanceData = K2.Configuration.SlotInstanceData;
                }
                else
                {
                    // Get the slot count and prepare the initialization
                    // data
                    slotCount = K2.Configuration.Slots;
                    slotInstanceData = new string[slotCount];
                    string initData = string.Empty;
                    if (K2.Configuration.SlotInstanceData.Length > 0)
                    {
                        initData = K2.Configuration.SlotInstanceData[0];
                    }
                    for (int i = 0; i < slotCount; i++)
                    {
                        slotInstanceData[i] = initData;
                    }
                }

                // Set the slot count and initialization data
                K2.Slots = slotCount;
                K2.SlotInstanceData = K2.Configuration.SlotInstanceData;
            }
            else
            {
                K2.DynamicQueues = K2.Configuration.DynamicQueues;
                K2.ResolveQueuesToUsers = K2.Configuration.ResolveQueuesToUsers;

                int setCount = K2.Configuration.SetCount;

                for (int i = 0; i < setCount; i++)
                {
                    if (GetRuleResult(i + 1))
                    {
                        AddDestinations(i + 1);
                    }
                }
            }
            
            K2.ResolveQueuesToUsers = false;

            string dests = K2.ProcessInstance.DataFields["dest_salesmanager"].Value.ToString();
            K2Context k2content = new K2Context(K2.Destinations, K2.ActivityInstance);
            k2content.InitDestination(dests);
        }

       #region - Helper Methods -

        private bool GetRuleResult(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetRuleResult{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return true;

            // Invoke the get
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return true;

            object retval = mi.Invoke(K2.Configuration, null);

            return Convert.ToBoolean(retval);
        }

        private void AddDestinations(int setIdx)
        {
            // Get the property that returns the result
            string propName = string.Format("DestinationSetDestinationTable{0}", setIdx);
            System.Reflection.PropertyInfo pi =
                K2.Configuration.GetType().GetProperty(propName);
            if (pi == null)
                return;
            System.Reflection.MethodInfo mi = pi.GetGetMethod();
            if (mi == null)
                return;

            // Invoke the get
            object retval = mi.Invoke(K2.Configuration, null);
            if (retval == null)
                return;

            string[][] destinations = (string[][])retval;

            // Results are returned in a jagged array. The first item contains the
            // DestinationType and the rest will be the users, groups or queues.
            for (int row = 0; row < destinations.Length; row++)
            {
                DestinationType destType = DestinationType.User;

                // Get the DestinationType
                switch (destinations[row][0])
                {
                    case "User":
                        destType = DestinationType.User;
                        break;
                    case "Group":
                        destType = DestinationType.Group;
                        break;
                    case "Queue":
                        destType = DestinationType.Queue;
                        break;
                }

                // Iterate through the rest of the list and add each
                // destination with its corresponding type.
                for (int i = 1; i < destinations[row].Length; i++)
                {
                    K2.Destinations.Add(destType, destinations[row][i]);
                }
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>b6bdc914b207435d92b0887aa8f60c26</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><DestinationSets><DestinationSet Type="SourceCode.Workflow.Design.SimpleRules.DestinationSet" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Destinations><Destination Type="SourceCode.Workflow.Design.SimpleRules.Destination" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>05c6a9a4346344ea94e36cf558e28d17</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[-1]]></Value></ValueTypePart></Parts><Guid>54bda5f2edc7441f99c2f3705be46e61</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>a18f3136a55f42938309a372610fbdd6</Guid><DestinationType>Group</DestinationType></Destination></Destinations><Guid>b59f55085c944ae798ff8b3519ea4cef</Guid><Name>Default</Name></DestinationSet></DestinationSets><Guid>3fd014c6ad5f48c4a6fd9f363dc69333</Guid><MetaData /><Parent ref="bd952f2d-0fd7-48dc-9261-ae9deb80abce&#xD;" /></SimpleDestinationRule><DefaultOutcomeSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>bca334c86c3e490c8bb4da6812d3c672</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRule_5ce56de852be4ed7a8bd22b9986c610e" x:Name="SucceedingRule_5ce56de852be4ed7a8bd22b9986c610e" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<IfElseActivity x:Name="RuleOutcome">
		<IfElseBranchActivity x:Name="RuleOutcomeTrue">
			<IfElseBranchActivity.Condition>
				<CodeCondition Condition="EvaluateRule" />
			</IfElseBranchActivity.Condition>
			<CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
		</IfElseBranchActivity>
		<IfElseBranchActivity x:Name="RuleOutcomeFalse">
			<CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
		</IfElseBranchActivity>
	</IfElseActivity>
	
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>738e24b38f7d45719d763e0c0ce3032b</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5ce56de852be4ed7a8bd22b9986c610e;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_5ce56de852be4ed7a8bd22b9986c610e : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5ce56de852be4ed7a8bd22b9986c610e K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

            		e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>61ebd62d97654c6497eca8acbca9213e</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class SucceedingRule_5ce56de852be4ed7a8bd22b9986c610e
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5ce56de852be4ed7a8bd22b9986c610e K2)
			{
				bool retval = false;
                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Started");
    			for (int i = 0; i < K2.Configuration.SetCount; i++)
    			{
        			if (GetRuleResult(K2, i))
        			{
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Event Evaluation Result: " + GetName(K2,i));
            			SetOutcomeResult(K2, GetName(K2,i));
          				retval = true;
		                break;
        			} 

    			}

                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.Helper", "Outcome Evaluation: Completed");
				return retval;
			}

			public static void SetOutcomeResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5ce56de852be4ed7a8bd22b9986c610e K2, string value)
			{
				K2.ActivityInstance.DataFields["Outcome"].Value = value;	
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5ce56de852be4ed7a8bd22b9986c610e K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.SucceedingRuleContext_5ce56de852be4ed7a8bd22b9986c610e K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>5ce56de852be4ed7a8bd22b9986c610e</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a61643b584be462a8200e33fff2d4eab</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="6091ded1-1ca7-4164-8811-f57ad66685b2&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>2c961745c58c472cad1110f292b4809c</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>fc417e7b616d442c8f1e1cd7aac64702</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>185643d9153643348c3411fa8b157cf9</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>9a2e7c59d85e4cd79d61a84d1f49b3f3</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>937286aa94164d6c8c765b169f2011bd</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9a783528dbb84f93947354010cde12cf</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>1948dbad801c4c7eb259b12d94b61662</Guid></Count><Guid>dc7dbb0fddbe495795e1b1200eaca17a</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>40d1284f23c44e95a60077bfc8b65e3f</Guid></ExpressionLevelPair></Expressions><Guid>fe5e3bb21c07489eab5c23165885a4c3</Guid></Rule><Guid>aed4aa49ceeb41c6bdd91b8c1493ea96</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>1577fce384cb4a24a87a592c3bbbe674</Guid><MetaData /><Parent ref="bd952f2d-0fd7-48dc-9261-ae9deb80abce&#xD;" /></DefaultOutcomeSucceedingRule><ClientEventItem Type="SourceCode.Workflow.Design.ClientEventItem" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>27932fef8f3c4c69899ec57bb8490231</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventItem_387847bbe8324f04a68437a9835a2141" x:Name="EventItem_387847bbe8324f04a68437a9835a2141" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToInternet</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToMobile</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendToExchange</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<ConditionedActivityGroup x:Name="ClientEventActivity">
		<ConditionedActivityGroup.UntilCondition>
			<CodeCondition Condition="UntilCondition" />
		</ConditionedActivityGroup.UntilCondition>
		<CodeActivity x:Name="SendToInternet" ExecuteCode="SendWorkToInternet">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToInternet" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToMobile" ExecuteCode="SendWorkToMobile">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToMobile" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
		<CodeActivity x:Name="SendToExchange" ExecuteCode="SendWorkToExchange">
			<ConditionedActivityGroup.WhenCondition>
				<CodeCondition Condition="ShouldSendToExchange" />
			</ConditionedActivityGroup.WhenCondition>
		</CodeActivity>
	</ConditionedActivityGroup>

</ns0:WorkflowContext>]]></Content></CodeFile><CodeFile><Guid>97b26fc4a6884cb6bb34abd7a91eb8c5</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using SourceCode.Workflow.Common.Extenders;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_387847bbe8324f04a68437a9835a2141;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventItem_387847bbe8324f04a68437a9835a2141 : IWorkflowContext<hostContext>
    {

		private bool internetExecuted = false;
        private bool mobileExecuted = false;
        private bool exchangeExecuted = false;
		private bool AllowAnyUserToFinishEventDone = false;

        #region K2 Context

        private hostContext _k2;

        #endregion

		#region Client Event Activity

		 private void UntilCondition(object sender, ConditionalEventArgs e)
        {
			if (!AllowAnyUserToFinishEventDone)
            {
                if (Convert.ToBoolean(K2.Configuration.AllowAnyUserToFinishEvent))
                {
                    K2.VerifyCredentials = false;
                }
                else
                {
                    K2.VerifyCredentials = true;
                }
                AllowAnyUserToFinishEventDone = true;

                K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
                k2context.BeforeAction(K2.Configuration.InternetUrl);
            }
            if (internetExecuted && mobileExecuted && exchangeExecuted)
            {
                e.Result = true;
            }
            else
            {
                e.Result = false;
            }
        }
		#endregion

        #region Internet

		private void ShouldSendToInternet(object sender, ConditionalEventArgs e)
        {
            internetExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToInternet);
        }

        private void SendWorkToInternet(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.InternetUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.InternetPlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
            
        }
        #endregion

        #region Mobile
        private void SendWorkToMobile(object sender, EventArgs e)
        {
            string strURL = K2.Configuration.MobileUrl;
            strURL = strURL.Replace("{SERIALNO}", K2.SerialNumber);
            K2.AddWorklist(K2.Configuration.MobilePlatform, System.Web.HttpUtility.UrlPathEncode(strURL));
            
        }

        private void ShouldSendToMobile(object sender, ConditionalEventArgs e)
        {
            mobileExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToMobile);
        }
        #endregion

        #region Exchange

        private void ShouldSendToExchange(object sender, ConditionalEventArgs e)
        {
            exchangeExecuted = true;
            e.Result = bool.Parse(K2.Configuration.SendToExchange);
        }

        private void SendWorkToExchange(object sender, EventArgs e)
        {
            K2.AddWorklist("EXCHANGEPROFILENAME", K2.Configuration.ExchangeProfileName);
            K2.AddWorklist("EXCHANGEFORMTYPE", K2.Configuration.ExchangeFormType);
            
        }

        #endregion


        #region Other Methods

        #endregion


        #region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventItemContext_387847bbe8324f04a68437a9835a2141 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
    }
}
]]></Content></CodeFile></CodeFiles><Guid>387847bbe8324f04a68437a9835a2141</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><NotificationMessage Type="SourceCode.Workflow.Authoring.NotificationMessage" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3ce97d7458994a35ab21233d57311f3f</Guid></NotificationMessage><InternetUrl Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a58134ccae6a429b8de133d6bd9a7d53</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="a7596807-0489-4127-9201-34dfced95c53&#xD;" /><DataFieldName>ActionURL</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bad23c901e34416d9e659fe49bd64266</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[?]]></Value></ValueTypePart><SerialNoFieldPart Type="SourceCode.Workflow.Design.SerialNoFieldPart" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0eeedcb8398d402698987165007e3ec6</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value>SN={SERIALNO}</Value></SerialNoFieldPart></Parts><Guid>5fce749aabfb49bf9aecfcb0141d51df</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></InternetUrl><Guid>e58f5458d460404099fae7b6128227d0</Guid><MetaData /><Parent ref="ec151a1a-e26b-49cd-ab23-0e7a962a4bf1&#xD;" /><SendToInternet>1</SendToInternet><InternetPlatform>ASP</InternetPlatform><MobilePlatform>ASP</MobilePlatform></ClientEventItem><DefaultOutcomeEventSucceedingRule Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeEventSucceedingRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>6f6450fc91a64534a4c3bb6abaf808a3</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRule_bff5db750976418abe3e8987ac63187a" x:Name="EventSucceedingRule_bff5db750976418abe3e8987ac63187a" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ns0:WorkflowContext.LockedActivities>
    <x:Array Type="{x:Type System.String}">
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcome</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">RuleOutcomeTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">EvaluateRule</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleTrue</ns1:String>
      <ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetSucceedingRuleFalse</ns1:String>
    </x:Array>
  </ns0:WorkflowContext.LockedActivities>
  <IfElseActivity x:Name="RuleOutcome">
    <IfElseBranchActivity x:Name="RuleOutcomeTrue">
      <IfElseBranchActivity.Condition>
        <CodeCondition Condition="EvaluateRule" />
      </IfElseBranchActivity.Condition>
      <CodeActivity x:Name="SetSucceedingRuleTrue" ExecuteCode="SetSucceedingRuleTrue_ExecuteCode" />
    </IfElseBranchActivity>
    <IfElseBranchActivity x:Name="RuleOutcomeFalse">
      <CodeActivity x:Name="SetSucceedingRuleFalse" ExecuteCode="SetSucceedingRuleFalse_ExecuteCode" />
    </IfElseBranchActivity>
  </IfElseActivity>

</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>ca0af0d67163440f8cefefb73732e66f</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using System.Xml;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_bff5db750976418abe3e8987ac63187a;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_bff5db750976418abe3e8987ac63187a : IWorkflowContext<hostContext>
	{
		#region K2 Context

        	private hostContext _k2;

       		#endregion

		#region IWorkflowContext<hostContext> Members

        	public Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_bff5db750976418abe3e8987ac63187a K2
        	{
            		get
            		{
            		    return _k2;
            		}
            		set
            		{
            		    _k2 = value;
            		}
        	}

        	#endregion

		private void EvaluateRule(object sender, ConditionalEventArgs e)
        	{

                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                    e.Result = SucceedingRuleHelper.AnyOutcomesEvaluatedSuccessfully(K2);
                }
                else
                {
                    e.Result = true;
                }
             
        	}

        	private void SetSucceedingRuleTrue_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = true;
        	}

        	private void SetSucceedingRuleFalse_ExecuteCode(object sender, EventArgs e)
        	{
            		K2.SucceedingRule = false;
        	}

	}
}

]]></Content></CodeFile><CodeFile><Guid>d7acf4c8ca2a4497a241c8b883c48478</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class EventSucceedingRule_bff5db750976418abe3e8987ac63187a
	{
		public class SucceedingRuleHelper
		{

			public static bool AnyOutcomesEvaluatedSuccessfully(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_bff5db750976418abe3e8987ac63187a K2)
			{
                bool retval = false;
                if (K2.EventInstance.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Started");
            			for (int i = 0; i < K2.Configuration.SetCount; i++)
            			{
                			if (GetRuleResult(K2, i))
                			{
                                K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Event Evaluation Result: " + GetName(K2,i));
                  				retval = true;
				                break;
                			} 

            			}
                        K2.ProcessInstance.Logger.LogDebugMessage("Outcome.SucceedingRule.EventHelper", "Outcome Evaluation: Completed");
                } 
                else 
                {
                    retval = true;
                }
				return retval;
			}

			private static string GetName(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_bff5db750976418abe3e8987ac63187a K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeName{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return string.Empty;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return string.Empty;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToString(retval);
		        }

		        private static bool GetRuleResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.EventSucceedingRuleContext_bff5db750976418abe3e8987ac63187a K2, int setIdx)
		        {
		            // Get the property that returns the result
		            string propName = string.Format("OutcomeRule{0}", setIdx);
		            System.Reflection.PropertyInfo pi = K2.Configuration.GetType().GetProperty(propName);
		            if (pi == null)
		                return true;

		            // Invoke the get
		            System.Reflection.MethodInfo mi = pi.GetGetMethod();
		            if (mi == null)
		                return true;

		            object retval = mi.Invoke(K2.Configuration, null);

		            return Convert.ToBoolean(retval);
		        }
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>bff5db750976418abe3e8987ac63187a</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Outcomes><OutcomeItem Type="SourceCode.Workflow.Design.Outcome.Base.OutcomeItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonListExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0c2d7c03d17b4728aadfd16361b89ad4</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="6091ded1-1ca7-4164-8811-f57ad66685b2&#xD;" /><DataFieldName>Action Result</DataFieldName><Scope>Destination</Scope><Type>String</Type><ListOption>Slots</ListOption></DataFieldPart></Parts><Guid>98d6501bf7fc4386876f50d0e2ccf387</Guid><IsList>1</IsList><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>7a8afb3fffd44c998083300d8fe578af</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0a4fb5f59cf64dde8565b0435d34b69b</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>b7dc4e295d1c4b1383ad48c52d98fd0d</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>bb50462a436d487daae33715f72e0977</Guid></Right><Count Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3cfb7910ee1f4151bd4c218d18bfd79f</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>b0ed7aba0de0498a8831a35a7562bf11</Guid></Count><Guid>7b8140c40cd84e078a52d5539bff78ba</Guid><Operator>Equal</Operator><ListOperator>All</ListOperator></Exp><Guid>0605e558e06247e0af5ea46633309a7f</Guid></ExpressionLevelPair></Expressions><Guid>9cdaa88091d54a019bbd7bf01eec63f4</Guid></Rule><Guid>25a73518100442e488633626be4265d0</Guid><Name>同意</Name></OutcomeItem></Outcomes><Guid>ecba67aba87f4e5d8fe392ea591f29d1</Guid><MetaData /><Parent ref="ec151a1a-e26b-49cd-ab23-0e7a962a4bf1&#xD;" /></DefaultOutcomeEventSucceedingRule><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>5c79c7291b5d43398c836d698394101d</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_4b73b213ec5d4e5586edbb8e4bb520cb" x:Name="ActionItem_4b73b213ec5d4e5586edbb8e4bb520cb" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>3aaae7e76b7b401c8bba15779fe200d9</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_4b73b213ec5d4e5586edbb8e4bb520cb;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_4b73b213ec5d4e5586edbb8e4bb520cb : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_4b73b213ec5d4e5586edbb8e4bb520cb K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>e1d8d71fd5904e49aba4babe050282f0</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_4b73b213ec5d4e5586edbb8e4bb520cb
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_4b73b213ec5d4e5586edbb8e4bb520cb K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_4b73b213ec5d4e5586edbb8e4bb520cb K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>4b73b213ec5d4e5586edbb8e4bb520cb</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>83b08964451f40eab9716bc1e58a9ad8</Guid><MetaData /><Parent ref="42eb0498-3cc8-4736-bd10-76b8a1d196ca&#xD;" /></DefaultOutcomeAction><DefaultOutcomeAction Type="SourceCode.Workflow.Design.Outcome.DefaultOutcomeAction" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>9878fb2d3d5a489098a2c52eec5a4969</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.ActionItem_8103d8223da5432f8d3e529aba67740a" x:Name="ActionItem_8103d8223da5432f8d3e529aba67740a" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	 <ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetActionResult</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">FinishAction</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetActionResult" ExecuteCode="SetActionResult_ExecuteCode" Description="Set Action Result" />
	<CodeActivity x:Name="FinishAction" ExecuteCode="FinishAction_ExecuteCode" Description="Finish Action" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>1aaef92b2010450a9f46a1e79464e9eb</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using DianPing.BPM.WFDevFx.K2;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8103d8223da5432f8d3e529aba67740a;
using DianPing.BPM.Common.AppSettings;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_8103d8223da5432f8d3e529aba67740a : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8103d8223da5432f8d3e529aba67740a K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

	private void SetActionResult_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.SetActionResult(K2);
        }

        private void FinishAction_ExecuteCode(object sender, EventArgs e)
        {
            ActionHelper.FinishAction(K2);
            K2Context k2context = new K2Context(K2.SerialNumber, K2.ActivityInstanceDestination);
            k2context.CompleteAction(K2.WorklistSlot.User, K2.ActionName);
            
        }
	}
}
]]></Content></CodeFile><CodeFile><Guid>4e7893230faa40b0be5d5cf0b0992dee</Guid><OriginalFileName>@safeitemname@Helper.cs</OriginalFileName><Primary>1</Primary><Content><![CDATA[using System;
using System.Xml;
using SourceCode.KO;
using SourceCode.Workflow.Common.Extenders;

namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class ActionItem_8103d8223da5432f8d3e529aba67740a
	{
		public class ActionHelper
		{
			public static void SetActionResult(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8103d8223da5432f8d3e529aba67740a K2)
			{
				K2.WorklistSlot.DataFields["Action Result"].Value = K2.Configuration.ActionResult;
			}

            public static void FinishAction(Project_fe8a038ea9ab4e2ab327ec5be381164a.ActionItemContext_8103d8223da5432f8d3e529aba67740a K2)
			{
                if (K2.Configuration.FinishAction)
                {
                    K2.Finish();
                }
                else 
                {
                    K2.Update();
                }
			}
		}
	}
}]]></Content></CodeFile></CodeFiles><Guid>8103d8223da5432f8d3e529aba67740a</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Guid>d45a54b94c8c4e16b390bb44983b1301</Guid><MetaData /><Parent ref="3a107f51-1967-4a21-9ce1-91384ea84472&#xD;" /></DefaultOutcomeAction><SimpleLineRule Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><CodeFiles><CodeFile><Guid>d76101e44c1143019074f499493d6366</Guid><OriginalFileName>@safeitemname@.xoml</OriginalFileName><Primary>1</Primary><Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a.LineRule_a9206307940d4bbc85016648c9bc3178" x:Name="LineRule_a9206307940d4bbc85016648c9bc3178" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ns0:WorkflowContext.LockedActivities>
    </ns0:WorkflowContext.LockedActivities>
    <CodeActivity x:Name="codeActivity1" ExecuteCode="codeActivity1_ExecuteCode" />
</ns0:WorkflowContext>
]]></Content></CodeFile><CodeFile><Guid>9f510ae759974bbca5bdeb42f9d7aa48</Guid><OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName><Content><![CDATA[using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Collections;
using System.Drawing;
using System.Workflow.ComponentModel.Compiler;
using System.Workflow.ComponentModel.Serialization;
using System.Workflow.ComponentModel;
using System.Workflow.ComponentModel.Design;
using System.Workflow.Runtime;
using System.Workflow.Activities;
using System.Workflow.Activities.Rules;
using SourceCode.Workflow.Common.Extenders;
using SourceCode.KO;
using hostContext = Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_a9206307940d4bbc85016648c9bc3178;
namespace ExtenderProject_fe8a038ea9ab4e2ab327ec5be381164a
{
	public partial class LineRule_a9206307940d4bbc85016648c9bc3178 : IWorkflowContext<hostContext>
	{
		#region K2 Context

        private hostContext _k2;

        #endregion

		#region IWorkflowContext<hostContext> Members

        public Project_fe8a038ea9ab4e2ab327ec5be381164a.LineRuleContext_a9206307940d4bbc85016648c9bc3178 K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion
        private void codeActivity1_ExecuteCode(object sender, EventArgs e)
        {
            K2.LineRule = K2.Configuration.Rule;
        }
	}
}
]]></Content></CodeFile></CodeFiles><Guid>a9206307940d4bbc85016648c9bc3178</Guid><MetaData /><Username /><CredentialGuid>00000000-0000-0000-0000-000000000000</CredentialGuid><Language>CSharp</Language></Extender><Rule Type="SourceCode.Workflow.Design.SimpleRules.SimpleRule" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Expressions><ExpressionLevelPair Type="SourceCode.Workflow.Design.SimpleRules.ExpressionLevelPair" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Exp Type="SourceCode.Workflow.Design.SimpleRules.ComparisonExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Left Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><DataFieldPart Type="SourceCode.Workflow.Design.DataFieldPart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>290312834dd343099d70fdc6866af516</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value ref="26c63ae4-4fc6-4d27-945f-7900fe463a64&#xD;" /><DataFieldName>Outcome</DataFieldName><Scope>Activity</Scope><Type>String</Type><ListOption>None</ListOption></DataFieldPart></Parts><Guid>7831b61580ba4cb38d96cfc6099344e7</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>e3ec0dd2fa894c8fa77835ddbf166334</Guid></Left><Right Type="SourceCode.Workflow.Design.SimpleRules.ValueExpression" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Value Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Parts><ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0f694ca013be4294bf2f0dafe67b5bee</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType><Value><![CDATA[同意]]></Value></ValueTypePart></Parts><Guid>67c7aee0171e4a9ca1032f54b559c9fe</Guid><ValueType>System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType></Value><Guid>693d9ed6242c49c5aad4f028e762f9d6</Guid></Right><Guid>d1f1ada657f5469888a5396fb4caf2ea</Guid><Operator>Equal</Operator></Exp><Guid>6acf1238baaf40ac815f61cccdb9bfdd</Guid></ExpressionLevelPair></Expressions><Guid>8da04113e18343589051de6c287145c5</Guid></Rule><Guid>c866dbcd1a024b7da2a79187085054b5</Guid><MetaData /><Parent ref="88174aef-83d0-456b-ba13-6d4932cb4288&#xD;" /></SimpleLineRule></ExecutableItems><Guid>0313d1be8b234675a1a81a10588fb818</Guid><Name>Default</Name><Description>This represents the default execution layer for the process.</Description></ExecutionLayer></ExecutionLayers><Lines><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bfa24a59080e41508245dd22bdb7f589</Guid><Name>{62f87732-aba3-41f4-9361-874af327a80b}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>7997cf5e023b4062bae231cd7d39522d</Guid><Name>{0d893c11-0ac1-476d-a400-a2a1481b63f4}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>01b9bbe2e3d843adbb058aa27b01c7b3</Guid><Name>{52478ae3-947e-491f-93ce-5d37aaa68760}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>66e9dddac4df4fc595e29541653f824c</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>fed11d46e9d0422eba504be782c32c3a</Guid><Name>DefaultLine</Name><StartActivity>Start</StartActivity><FinishActivity>流程初始化</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9568c5dff5fd4527bfeb7761c18b2cfc</Guid><Name>{c0c6789f-7429-40f0-b3f7-d41328d91e5d}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6349366e221841fa8a20d9d44d1c6c89</Guid><Name>{11593e24-37bd-404c-b4c8-98abcac2887a}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>10cd7de797dd4994a22b5040b0caecdb</Guid><Name>{f7e38a78-2bce-468b-af6d-dfcb439cfc4b}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>878711e774044e418abfb7613e269d7c</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>54bb9fda258441b29e729563d14de5ee</Guid><Name>重新提交</Name><Description>Default Line generated originally from the 重新提交 Outcome.</Description><MetaData>重新提交</MetaData><LineRuleGuid>35fbecfb-5616-44b9-84e6-92a80abcd628</LineRuleGuid><ExceptionGuid>00000000-0000-0000-0000-000000000000</ExceptionGuid><StartActivity>发起人</StartActivity><FinishActivity>流程初始化</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>020816a15af640c29ff337058bddd368</Guid><Name>{8bd207a0-aa72-41db-acfd-28b2b79d15cc}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>32023e0160274aa9982b7782f09e834e</Guid><Name>{ea5688c7-e232-4598-8f71-4bfc043da1ac}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6b3e305ef5cc45229fe8e3bb73d8e5f2</Guid><Name>{d69ae89a-271a-495d-906a-cdfe91007919}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>02bc256ffa994007b0a9a91df8c715bc</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>2ce763623a13490793cecc703db886b5</Guid><Name>结束流程</Name><Description>Default Line generated originally from the 结束流程 Outcome.</Description><MetaData>结束流程</MetaData><LineRuleGuid>44428eee-bdca-4b8e-b000-37cfc4a1d37f</LineRuleGuid><ExceptionGuid>00000000-0000-0000-0000-000000000000</ExceptionGuid><StartActivity>发起人</StartActivity><FinishActivity>流程撤销</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2015b79337d64436a6989a33bb788537</Guid><Name>{9af4bd32-e334-49a1-ae16-cb5f1d5a2f3f}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>75e83e68b95e4494b3a19269e43e07d8</Guid><Name>{3ff4e305-6e28-48e3-8d96-932605a2f98d}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>26e05a6f2d2b49678151c885befce6c4</Guid><Name>{df7608eb-8bea-45fd-82c0-52e0c7c76239}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>812e8e6e51b1453792cfdb7b5e4fc017</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>82026e7e7b7940a681e48d24e229f6cb</Guid><Name>DefaultLine1</Name><StartActivity>流程初始化</StartActivity><FinishActivity>城市经理</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>14605a4f45df4c329ec9a9cfa04d334a</Guid><Name>{c8b53204-b199-4d05-9d37-01bfd2004fdd}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a41f710702d244fa9b2aff9db8bea543</Guid><Name>{c88452f7-f21a-47e4-9121-f03c003a5073}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ed356ebfb4c84a81aaf50b4e32440795</Guid><Name>{732b9d5c-35b0-47af-82f7-8dade2e0da41}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>c68b1cfc4d6e4322af7426dda52df496</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>d028172042f940de836662eb363d01ba</Guid><Name>DefaultLine2</Name><LineRuleGuid>f9023b08-1c8b-424a-99e5-dd9e303367eb</LineRuleGuid><ExceptionGuid>00000000-0000-0000-0000-000000000000</ExceptionGuid><StartActivity>Start</StartActivity><FinishActivity>流程未通过</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>eea3302697ec4a9ba172ccec2887e091</Guid><Name>{1a6fce44-32e8-4590-913f-c63868736caf}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1b7457ca71fa475f90aa9d310867bec6</Guid><Name>{204fea5a-e66b-4900-afc8-a3a48f7b6ac8}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9a07b520693f46b888f6e1be2c94fc62</Guid><Name>{d58a9ce5-7719-4c23-b7fc-280810a5805b}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>552361d115fb4ae59d282c2eb46ce219</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>f3617d957f214ca49ad094d04db35ef0</Guid><Name>DefaultLine3</Name><StartActivity>流程未通过</StartActivity><FinishActivity>发起人</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5088199590b04a1f9a0d7eaa5cd73681</Guid><Name>{6f527e07-a297-4956-94f7-7aeb2f0870f3}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d0bbd6418671474e93a2956e1cd60775</Guid><Name>{c7a91f21-b2b6-4d7d-a6df-c53ad43e6a4a}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b5a4658653934715a8e735412bebc545</Guid><Name>{1a47b91c-1c83-4fa9-a0f6-361e4ddd0655}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>08f395936d58406a8012519c82ea3bce</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>91335fd8cab249a09426d2efe1cf51cb</Guid><Name>同意2</Name><Description>Default Line generated originally from the 同意 Outcome.</Description><MetaData>同意</MetaData><LineRuleGuid>63bdbfdd-2f90-4110-b06a-04701c2eace3</LineRuleGuid><ExceptionGuid>00000000-0000-0000-0000-000000000000</ExceptionGuid><StartActivity>城市经理</StartActivity><FinishActivity>地区经理</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0227e3738e2e4c3d84d88c61835f5bf7</Guid><Name>{e8410287-0d7f-4b5b-ae53-ed14c145e18b}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>72bd65bd99a54481a239a0c1f3c05f22</Guid><Name>{52a89e30-ae8d-49fc-a0c6-5842427350e3}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c67114ed01ac457cb627f14795246a01</Guid><Name>{963c4d86-dbbe-47fc-b396-f287fbeb97dc}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>44316c8320b44882ba6c208fd55b0258</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>9fed9f02ae744de78d68b0e6464c25ee</Guid><Name>同意</Name><Description>Default Line generated originally from the 同意 Outcome.</Description><MetaData>同意</MetaData><LineRuleGuid>30833d49-c76e-45aa-aa9f-800047f4413d</LineRuleGuid><ExceptionGuid>00000000-0000-0000-0000-000000000000</ExceptionGuid><StartActivity>保补审批员</StartActivity><FinishActivity>保补一级主管</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d339d98a8f784ec786cb9ede7831bc55</Guid><Name>{d67a84de-23c9-4e44-a3bc-e6043412131a}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2167025820eb4704b82bc62e99b013bc</Guid><Name>{02c01f6e-6f80-4a98-939d-1fbfb97d965d}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bac43c754dc048d68b7b9d6ec4b2cbb5</Guid><Name>{355e851d-fb94-4693-a79e-e59cc3d45cad}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>84f0b2cbf02e47289723cc0283c84fc6</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>d7b82295800a4ef1a608fa63a9808893</Guid><Name>同意1</Name><Description>Default Line generated originally from the 同意 Outcome.</Description><MetaData>同意</MetaData><LineRuleGuid>a2e1a5ad-dab3-45b5-8e95-a66b40744bd6</LineRuleGuid><ExceptionGuid>00000000-0000-0000-0000-000000000000</ExceptionGuid><StartActivity>保补一级主管</StartActivity><FinishActivity>流程通过</FinishActivity></Line><Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>eee1e95c459842d9a91bf6a055433949</Guid><Name>{b570ca9b-e4ee-45f6-ace4-a7f11a2bdfef}</Name><RegisteredItem>Line General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0432463720f846b7b0fc9d2c60d41a97</Guid><Name>{f536f286-bd1e-4e90-80f7-acc9984b1491}</Name><RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>927a6e66612447a58fcaf6fbc53a2618</Guid><Name>{6a3bd5f2-13c1-4030-a06b-d7dc8f4358f8}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>676c465e2bf34fc891d8432c59dcd25a</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Line Wizard</RegisteredItem></WizardDefinition><Guid>88174aef83d0456bba136d4932cb4288</Guid><Name>同意3</Name><Description>Default Line generated originally from the 同意 Outcome.</Description><MetaData>同意</MetaData><LineRuleGuid>c866dbcd-1a02-4b7d-a2a7-9187085054b5</LineRuleGuid><ExceptionGuid>00000000-0000-0000-0000-000000000000</ExceptionGuid><StartActivity>地区经理</StartActivity><FinishActivity>保补审批员</FinishActivity></Line></Lines><Activities><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Events><Event Type="SourceCode.Workflow.Design.ServerEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultServerWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a840bbcece3647778360ed090bc4e884</Guid><Name>{8659af9d-e40e-49da-9b8d-21b75a280ab4}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9786746ec13d45f6bef54f6e31063729</Guid><Name>{1eaf07d7-e715-4ebd-84fe-62ef1860b36f}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>09a354581a6540338c3d15424bf28fd9</Guid><Name>{6ebf14fb-910d-4aed-a86d-434cdf00f057}</Name><Status>Executed</Status><RegisteredItem>Default Server Event - Code</RegisteredItem></WizardDefinition><Guid>3731415a97fe45eeba3858bc84dd234f</Guid><Name>初始化流程号</Name><EventItemGuid>5641ca9c-444f-4695-8193-3a1a574e6c90</EventItemGuid></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5ecde8dae66c473a9dccd5cc3aba1971</Guid><Name>{7745c743-1dff-4c59-b621-b299256c4c5e}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>51880697170c49588450d93d822a90bd</Guid><Name>{8a22e94a-f0de-42b5-8936-f57f0b8fd708}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>19bffc3f154c465380a7865985b2d010</Guid><Name>{f910b64d-9fdb-4767-aa9e-97622ee2af8e}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>7da7fa0212f941abba1d536003fadac2</Guid><Name>{0f8ba821-5b4b-4818-bf95-a150f58b7077}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a7c29514b11c4795ada4c50c66a8e9a9</Guid><Name>{85320da7-7ebb-4c2a-993b-ccd6e7410fc7}</Name><RegisteredItem>D432E2E2-E5EC-476a-9647-B30702805FBF</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>43092f2c5e02486484b17d65b819eda4</Guid><Name>{da8602c9-af3e-471b-aa57-1af773612b20}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0d0e7fe5a5984fea9b43bb2fadc48613</Guid><Name>{46a26cfe-c33f-4513-b6f1-8a2ebdd6baf6}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>6c7290221de840f89a52d3527d8ebfe6</Guid><Name>{71ac40e9-a134-40a2-ba92-5636e515db75}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>5d4e06c0b05b49f3b4c3ff6f298e0f64</Guid><Name>流程初始化</Name><Slots>1</Slots><Type>DestinationInstanceParralel</Type><DestinationRuleGuid>67cb2a78-cfa9-4e39-9c93-daf4c434b735</DestinationRuleGuid><PrecedingRuleGuid>d65cc512-1abc-42b4-93ef-5540d985a178</PrecedingRuleGuid><StartRuleGuid>e902456e-6245-4a77-8312-901544fcfb4c</StartRuleGuid><SucceedingRuleGuid>4ffb8314-964a-4ea9-a55b-a624c2fd156d</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><DataFields><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5509b9522b8745e6ab2366cdf2e6e5e9</Guid><Name>ActionURL</Name><Audit>0</Audit><Type>String</Type><Scope>Activity</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>802af15f879c4a85b5f36f47d5f69e61</Guid><Name>Action Result</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Destination</Scope><Category>Outcomes</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f0688f638b7541a1b1e331cb7f840c3a</Guid><Name>Outcome</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Activity</Scope><Category>Outcomes</Category></DataField></DataFields><Events><Event Type="SourceCode.Workflow.Design.ClientEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Actions><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>cd52caed1809498ab9ce35e694eb3e72</Guid><Name>重新提交</Name><ActionItemGuid>a792de7d-0307-4634-a812-1049e4b00523</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6ad263fccc574b61923681947e2614fa</Guid><Name>结束流程</Name><ActionItemGuid>7599189b-cc64-4a3f-a665-5b1ec70bcc1b</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction></Actions><WizardDefinition Type="SourceCode.Workflow.Design.DefaultClientWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>51feda8846ea493f8f0d6b317dbe4672</Guid><Name>{de2507ea-a9ac-446f-92c4-b35be289bf24}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.DefaultClientPropertyWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>32fd004ef1804450a6e472124ede8aaf</Guid><Name>{f6475006-b5bf-4d43-b484-a4d39d294f9d}</Name><RegisteredItem>Client Event Item Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c757fe6000e6466493bf14e17479dbca</Guid><Name>{4f2b8e01-0c77-41ab-8311-cc821763375b}</Name><RegisteredItem>Event Actions and Outcome Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c6b409c061bc4e6a968113010ac58a04</Guid><Name>{ba73b331-e345-464a-8032-0744cb0e7a75}</Name><RegisteredItem>Event Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>474c5b5cb192416e937e0595ef0e1113</Guid><Name>{d7dcecf0-65b7-4232-9a9e-fc18d6db7d2c}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>b0e3bb24a8434b759db12b73ae631636</Guid><Name>{a48ef754-52fe-49af-be83-912467971aa7}</Name><Status>Executed</Status><RegisteredItem>Default Client Event Wizard</RegisteredItem></WizardDefinition><Guid>1c0fd53a7e2c4ee39a3c2e73c2484ee0</Guid><Name>发起人重新发起</Name><EventItemGuid>551ee993-955f-4787-8677-9ac1a5f26bb9</EventItemGuid><SucceedingRuleGuid>851072ef-073f-475e-b14b-843db3022ddc</SucceedingRuleGuid><Type>Client</Type></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a7eb37ec773441d09f114c68470c40cd</Guid><Name>{fc6a764b-dc00-47d2-836a-21f22e2e1909}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>aaa2b1af822642119da7c11dc06fda5f</Guid><Name>{57f850d0-fb6a-4198-8a2c-7eb141ff4036}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>838c63325ed74007aa440d3053990695</Guid><Name>{dc8f9ea2-03ed-4a1c-8c63-04ac50f9f79c}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ce35de75e627461cb88d13ea5da3daf3</Guid><Name>{fe850bfd-0809-485e-a0ca-ff0f46c397dc}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem><RunAdvancedMode>1</RunAdvancedMode></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b4bee149b4d04396a9ba375f14418cee</Guid><Name>{16aebdd9-7c4a-408b-9406-aa9c47a0f8aa}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f43e41d536ee484197d39d84beaee3a3</Guid><Name>{15886000-6e6d-409d-b271-444fab348065}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomeSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>67160b0cb6f542a080bd1ae2adcd3602</Guid><Name>{7a30f6c1-1cdc-44a0-b7c9-532b76815ae5}</Name><RegisteredItem>C76701EE-F9D5-40f8-AD2B-0E954A21DF3D</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>2b91fb187802440c91760a0b6db14714</Guid><Name>{56b9c0d0-e285-4d50-a91e-0c200a0d7234}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>43cde613cb034d1a91ae5075924cd4e4</Guid><Name>发起人</Name><Slots>1</Slots><Type>DestinationInstanceParralel</Type><DestinationRuleGuid>f57cfc31-f003-4fb6-af28-e96ed3932f84</DestinationRuleGuid><PrecedingRuleGuid>4deaf865-a5cb-4cde-8169-d5b4f8c093c3</PrecedingRuleGuid><StartRuleGuid>890a8e7d-0a10-45b8-9c69-63671f8054d3</StartRuleGuid><SucceedingRuleGuid>8f8198ed-8b2a-459e-a3a7-c292fa53c459</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Events><Event Type="SourceCode.Workflow.Design.ServerEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultServerWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f9bbd18fc3d74b158b08a43d5f0e77bb</Guid><Name>{1b0fe429-1673-4f58-83dc-4a1841ba5480}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0c25898d8fe045ea9efb4331f55ef092</Guid><Name>{336bdbac-f410-4682-b9c7-d8ece37cb987}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>9865ed20c62d4409a70733f8a41ab8ac</Guid><Name>{6eb12925-68fa-4dbe-bcd6-bf783904b5c1}</Name><Status>Executed</Status><RegisteredItem>Default Server Event - Code</RegisteredItem></WizardDefinition><Guid>f7d1af2e2a654c9d834ff6c9ae167d30</Guid><Name>流程结束</Name><EventItemGuid>c19ec0d7-2e00-42f0-a796-f4eb1140881b</EventItemGuid></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c2ac50795e8c42a99760c52fb3437b75</Guid><Name>{5b43a0cd-5ce2-4bf9-966b-c7696055660d}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3f5c5bd436434c949829fed390b55ec3</Guid><Name>{fd90d27b-4c55-4d5d-90ec-dfd3d15e2b0e}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5bd73f822f9b4a789090c84e5d07fe0d</Guid><Name>{f174abff-342f-4787-bb1a-5b6b912e0b22}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b937524b8ba64402b5cc09bd88af2fca</Guid><Name>{09155e3b-13e0-4528-8211-2852c086493c}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b2bc7a9735e44c9794680aa069e982d7</Guid><Name>{64868efc-b907-4978-a677-e03069740c77}</Name><RegisteredItem>D432E2E2-E5EC-476a-9647-B30702805FBF</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2f7dad0c5a704443af2bd5cc0c8ae84e</Guid><Name>{6a25ca2e-5471-4ec2-9b0f-3b70a6848031}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>54c4bc4fa83e443e9b54ec37b0b23c68</Guid><Name>{d4f7082d-5608-4b9d-bfb3-44e143abfb7e}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>a6ca9c7791344b9f87ee99a25844eff7</Guid><Name>{e77d1e3b-0977-42f2-a95a-7c259cdd646e}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>f154d5f6b4e24e54a80c9f558d0457f4</Guid><Name>流程撤销</Name><Type>SingleInstance</Type><DestinationRuleGuid>19a69b1e-9ffd-4849-9fe8-ed1d5f3fb1eb</DestinationRuleGuid><PrecedingRuleGuid>37a513c4-ae13-4102-8f14-e35728049e02</PrecedingRuleGuid><StartRuleGuid>926cc959-1ff0-4666-be91-eb6b2fc6bcf1</StartRuleGuid><SucceedingRuleGuid>0aeb1373-7fb6-47fb-bc36-402861cce079</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Events><Event Type="SourceCode.Workflow.Design.ServerEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultServerWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1943cf44db564dbc8fac91bc3c850c65</Guid><Name>{9d37322f-6af0-4810-a839-47f63fb76067}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>06b2fc99da124681b004598540ff36b5</Guid><Name>{feb88c72-94de-4b7f-bd76-94ce024811a8}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>adef6adf59f046a8bf6760a704000825</Guid><Name>{c9c50503-a09a-47a5-9003-769e7217a36f}</Name><Status>Executed</Status><RegisteredItem>Default Server Event - Code</RegisteredItem></WizardDefinition><Guid>969129ceb917417aa3a5c6984df62cf7</Guid><Name>流程未通过</Name><EventItemGuid>d3c6c848-c829-442f-a9e8-c9a6cf3c55cd</EventItemGuid></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>01a6dbd9d0ec4c2aa838d00b55715ab1</Guid><Name>{bbf6a35e-3aae-47ba-97e5-e41b4d98d08d}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ff494626919247c48859761aa1b65e02</Guid><Name>{cc26815b-3cc8-4874-844f-6693fc351973}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>44c209e3d2624fd598cf6abf57e15ae2</Guid><Name>{946249c8-b90d-4889-bea9-8b81e91c6be9}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2ad4b4cccf494388bc56ec137f70d858</Guid><Name>{499ae6b9-d816-499d-9334-91f60f3ef7ee}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b6e2c0489de94aeeab143a7147fcd844</Guid><Name>{80d17dc5-9eb9-4394-8e65-fc1e0e0d1cad}</Name><RegisteredItem>D432E2E2-E5EC-476a-9647-B30702805FBF</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>38fce757656b4a5381fc2d0df4132a51</Guid><Name>{e45141b3-1279-46d2-9382-4d1de0bfc4c6}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>be6569cee48d4168aa0597a22a6ac363</Guid><Name>{4f1bb4f9-6ead-458b-9a92-96802fdeefc1}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>46c47ebb8ab14841b2dfb0fb46a8b970</Guid><Name>{bea36a5b-0bd2-4b33-851d-eab6f3e41653}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>a86b3c6997ae4caebc6fddb9c1287aab</Guid><Name>流程未通过</Name><Type>SingleInstance</Type><DestinationRuleGuid>a5503454-c67e-4daf-9014-4095da2dc266</DestinationRuleGuid><PrecedingRuleGuid>6c20d7ff-76b5-4442-8242-4651d9a97957</PrecedingRuleGuid><StartRuleGuid>3afed608-96e3-4de5-9f86-daf269e1a262</StartRuleGuid><SucceedingRuleGuid>cd75baa2-f3bc-4c35-8744-ee25235419b4</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><DataFields><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>27d9d8b156984220a8bf7f147e42ade9</Guid><Name>ActionURL</Name><Audit>0</Audit><Type>String</Type><Scope>Activity</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b68017a5b0154755b16fad42b235c89d</Guid><Name>Action Result</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Destination</Scope><Category>Outcomes</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>542d761a3a80430db0a3bc21bde1d7b7</Guid><Name>Outcome</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Activity</Scope><Category>Outcomes</Category></DataField></DataFields><Events><Event Type="SourceCode.Workflow.Design.ClientEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Actions><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>41259bed67f646eb9a9be16f0fc7559e</Guid><Name>同意</Name><ActionItemGuid>0d8c454b-dfd6-4b80-958e-989ecba8563d</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d846e6ea586b4907b5336b0d82358277</Guid><Name>拒绝</Name><ActionItemGuid>e885b76c-e58d-43d7-9bc8-9140b4701500</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction></Actions><WizardDefinition Type="SourceCode.Workflow.Design.DefaultClientWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>321742a6913a4dc9aa3001103556418f</Guid><Name>{c146e8d9-24d6-48c3-8123-06248c57764c}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.DefaultClientPropertyWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b76261119c3a454d99901f717f995869</Guid><Name>{286e2f97-2d9a-4ed4-a754-9f39de03caa6}</Name><RegisteredItem>Client Event Item Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>05dbaa819eb54f7db443d2b8164544a0</Guid><Name>{c80646fe-b06f-404b-aeb7-b476dae6f3e9}</Name><RegisteredItem>Event Actions and Outcome Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>38faaee0fe7248a5aebcdca2e8d38978</Guid><Name>{4f9fffe2-175e-49a5-9fad-ce82c18ee4e8}</Name><RegisteredItem>Event Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>89396c538af4465c9efda1b8e4370a96</Guid><Name>{7b393fa1-d18d-471f-b017-4efeb06b1d44}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>711d6ff907314a7d9d29024532f6c77a</Guid><Name>{cef72f2a-05da-4975-a308-7e5fdbb9d3a5}</Name><Status>Executed</Status><RegisteredItem>Default Client Event Wizard</RegisteredItem></WizardDefinition><Guid>9a1cc6230a7141508bfc9af0d225f6c9</Guid><Name>城市经理审批</Name><EventItemGuid>62c64243-f688-4228-b61c-c679d4185bdb</EventItemGuid><SucceedingRuleGuid>c8c536a5-79d0-453a-aa83-540bc139a78c</SucceedingRuleGuid><Type>Client</Type></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>529f9017d7c44ad8a45b73ce67718835</Guid><Name>{38a33de8-272f-4c44-899a-f9db3196459b}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>420f024e02f749fcaecd7064bc20d967</Guid><Name>{10b55a93-a588-4fd1-aadd-ba02b9429515}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>e483725759e54f6488d8a3d97e464de0</Guid><Name>{dafc19f4-1e58-4e31-9e14-37facb5a5936}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a0c29156c8e74992940e89199ec203f4</Guid><Name>{bb0643ea-9746-454c-bce7-29adffd657ec}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem><RunAdvancedMode>1</RunAdvancedMode></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>06c5a1e06f9141b6b89c6e45306c22e2</Guid><Name>{df4200cb-391c-4073-9843-5429e2ab43cc}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c1a32eb93434490e8abfaf9cc9aa60a4</Guid><Name>{a2b0bbaa-5c1c-487d-9edf-d42844294a13}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomeSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f006e11887d24c93b24d85c660fcebf6</Guid><Name>{8fd3ef5d-480b-4873-9a4a-0750dba74015}</Name><RegisteredItem>C76701EE-F9D5-40f8-AD2B-0E954A21DF3D</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>1bbb3da0262a4352bcc8e8e39c8bb9ed</Guid><Name>{18c8cd1e-c852-43d0-9070-d5b1d896fe05}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>ba7c03346c7d4419ba009b2c31cd0435</Guid><Name>城市经理</Name><Slots>1</Slots><Type>DestinationInstanceParralel</Type><DestinationRuleGuid>31061216-322a-4cc3-9b0a-6a97a98b64ea</DestinationRuleGuid><PrecedingRuleGuid>c84d633f-dd26-4dae-85da-f2c0eb58e710</PrecedingRuleGuid><StartRuleGuid>2478fb44-9839-4fec-86c1-74ed8f850ad7</StartRuleGuid><SucceedingRuleGuid>ef2dff32-9e43-4395-8d5c-b6a22102d069</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Events><Event Type="SourceCode.Workflow.Design.ServerEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WizardDefinition Type="SourceCode.Workflow.Design.DefaultServerWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>4d36dd37822b4413bee92aa76ea9b037</Guid><Name>{6e574326-5e1a-4b78-8ef0-e80c2d4e514e}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>244d8e64087f4f68ac7eefc954462ef2</Guid><Name>{cedf40e0-cb48-42d1-bd63-1fe033677776}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>ed9eeaa069964a9ca3acaf59387dd214</Guid><Name>{100d94d7-0467-4fb5-9827-656f60d3ca5a}</Name><Status>Executed</Status><RegisteredItem>Default Server Event - Code</RegisteredItem></WizardDefinition><Guid>d476475a68ca47868ea7660dfba7e1d7</Guid><Name>流程结束</Name><EventItemGuid>c3348432-4a92-496d-97ae-6af9fcacaad4</EventItemGuid></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5b36d7d6816f44468c20da1778266065</Guid><Name>{6246075f-1c7b-4dad-a6c3-e153e3064985}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>923a7ad79a404bc590e5e79c600d6eda</Guid><Name>{3707597c-f13d-4611-bbaa-e7f9581b4a07}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ee2c2feac4d44291abce9406a825be39</Guid><Name>{5fa34bb6-08df-45cf-8a37-7918fde777fc}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>55fc46b8f41d459a9ce7bdccd2481866</Guid><Name>{7400a08e-ed55-4335-821a-e5348852fba8}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>accea34f5932447d8007503fc244c6c4</Guid><Name>{7eb2eb28-7264-4a90-9990-ea5749f6d500}</Name><RegisteredItem>D432E2E2-E5EC-476a-9647-B30702805FBF</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>386e4e85a5fd4580a35cb3991133e8ee</Guid><Name>{234cfa8a-7f76-41de-a4cb-23ef47511de8}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>274c22d88dcc4842aed27954c90d4f96</Guid><Name>{dd7e5dfd-4277-4100-b2d7-10d611016d01}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>67fbbdec3a5c4fad9a1c835bf14fac76</Guid><Name>{9a7ae70b-cb5f-4402-be96-6f6638812714}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>4607d31999e94211ae48a66248cfe1dd</Guid><Name>流程通过</Name><Type>SingleInstance</Type><DestinationRuleGuid>35a33a51-7021-4d7a-aaa9-a7587d0acd13</DestinationRuleGuid><PrecedingRuleGuid>33456a1e-fbe1-4d37-8f64-233a5ce5e88b</PrecedingRuleGuid><StartRuleGuid>484faf8d-f6bf-4cfc-a7cb-3c64bd147618</StartRuleGuid><SucceedingRuleGuid>a3beed01-255f-4559-a3c2-97a7831b1483</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><DataFields><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0700f44b1a53454c912eb169c5860dc8</Guid><Name>ActionURL</Name><Audit>0</Audit><Type>String</Type><Scope>Activity</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3d4f694e22d8473c89d270d53ee5a437</Guid><Name>Action Result</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Destination</Scope><Category>Outcomes</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>dd47cd554468438588a0e56b9843b476</Guid><Name>Outcome</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Activity</Scope><Category>Outcomes</Category></DataField></DataFields><Events><Event Type="SourceCode.Workflow.Design.ClientEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Actions><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>cd05b7c79399406989be4957b09833fa</Guid><Name>同意</Name><ActionItemGuid>51086f6b-1c9d-49ad-9814-0bcc44a326f7</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>52ec26918f2142848fe9c8b0aa940b95</Guid><Name>拒绝</Name><ActionItemGuid>b4b31924-df0e-42bd-ad07-c0fbbe27963a</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction></Actions><WizardDefinition Type="SourceCode.Workflow.Design.DefaultClientWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3bbb8975d1a54d64a9239ac19103fc79</Guid><Name>{d7e5f2cd-d208-4da6-8529-06f8abe54896}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.DefaultClientPropertyWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6e15bfb745474a05bae89e1f9c70db42</Guid><Name>{4771adc3-69a2-424f-97af-31b12be5870a}</Name><RegisteredItem>Client Event Item Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>4ac7893ca3714cf882155855a01c50bf</Guid><Name>{008c3db6-e651-4719-aec9-ecbd293bdb39}</Name><RegisteredItem>Event Actions and Outcome Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>10b1360186a34a7ab408a448d3d9127f</Guid><Name>{2f54c501-003a-4ecb-b767-db7f2b3a97a7}</Name><RegisteredItem>Event Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1f01cdb308214ab089ff6702494d547c</Guid><Name>{e6a0406b-acd7-4da8-b979-1a76ca76b443}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>c49bdee470c54629b9817c211df8d23f</Guid><Name>{3e2ce8e5-ff4c-4655-b8f1-1290348cc011}</Name><Status>Executed</Status><RegisteredItem>Default Client Event Wizard</RegisteredItem></WizardDefinition><Guid>44c1278e212c4f83be861b3ea0eea6ae</Guid><Name>保补审批员审批</Name><EventItemGuid>cea9b448-c475-4294-a438-dd8afd43d0ca</EventItemGuid><SucceedingRuleGuid>16a5ca26-4136-4153-b578-955a6da26a0b</SucceedingRuleGuid><Type>Client</Type></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>da34b0428112445eb7c1aab16746d6f8</Guid><Name>{e29a8dc2-5a1d-4cda-97ea-8b8a0f91d48d}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6052460527ea46d5a0583e95cf9743b1</Guid><Name>{53571121-b440-4bc1-b20e-e567e1868998}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>8b0acf909c3347f7be0c4c3642c9d228</Guid><Name>{dff6fed8-63d4-44bc-81a0-e5a600b94cb5}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ed91c78ffc084e9386bffd4ff5e27dc5</Guid><Name>{7df9c898-12f8-4b19-8895-02e129453e46}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem><RunAdvancedMode>1</RunAdvancedMode></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>36ff6d16d8864da6a0f8e1644aaa7eeb</Guid><Name>{97102bee-fb5d-4b42-a3af-0fd9db8fce38}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f29ef8525ce94b36a5d56762b9c02b2b</Guid><Name>{122c62d5-25a9-4c59-99db-d504f8eae2d3}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomeSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>8521125d2fdc45c6bd0e813b41960536</Guid><Name>{80760a07-5948-4a26-9b2c-29c6ad8aef2e}</Name><RegisteredItem>C76701EE-F9D5-40f8-AD2B-0E954A21DF3D</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>a8b0693b6c84481285dc347a61587bce</Guid><Name>{c09c5f9a-4cdd-4320-8773-e4e303628955}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>1cea4bea345b4cc098d0441da2427b85</Guid><Name>保补审批员</Name><Slots>1</Slots><Type>DestinationInstanceParralel</Type><DestinationRuleGuid>4e733b8e-9fbb-43ca-8e48-7b4e1f67784a</DestinationRuleGuid><PrecedingRuleGuid>bb9c1c28-c3d9-4d59-83e6-b6491d814dde</PrecedingRuleGuid><StartRuleGuid>5eb73723-a1a2-4a72-8924-f58e52ab8a68</StartRuleGuid><SucceedingRuleGuid>bf3758d4-24f2-442f-ace3-72c9d3390c41</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><DataFields><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f33d7d62eb0342c68e3c41e12898ba6c</Guid><Name>ActionURL</Name><Audit>0</Audit><Type>String</Type><Scope>Activity</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>dc83ad39c1564b87ab5f353b0be078d4</Guid><Name>Action Result</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Destination</Scope><Category>Outcomes</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>77373408659c41a88f9062214a62a4ec</Guid><Name>Outcome</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Activity</Scope><Category>Outcomes</Category></DataField></DataFields><Events><Event Type="SourceCode.Workflow.Design.ClientEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Actions><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1750cc0695664dceb46789c9fb2e4b1f</Guid><Name>同意</Name><ActionItemGuid>98d71466-9998-4863-8543-94747170be8f</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ff865f4c811e41e5b70cd9bcd68cb2e6</Guid><Name>拒绝</Name><ActionItemGuid>79034cd5-1acb-4d20-ad55-391f2651b61b</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction></Actions><WizardDefinition Type="SourceCode.Workflow.Design.DefaultClientWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3b4362e719d84fc3a428abf338029934</Guid><Name>{4570820e-35af-47c0-a837-9b99ec091549}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.DefaultClientPropertyWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>e8daf21fa43f47eda7dc8e6a68f5399f</Guid><Name>{72c5d41f-965d-447c-a837-2bcc9fe27168}</Name><RegisteredItem>Client Event Item Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>14215880d6494538aaa9ba8597d51c01</Guid><Name>{c69c5d8d-8dce-4c7b-9944-f9a53a4cbc7c}</Name><RegisteredItem>Event Actions and Outcome Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>53569282e2a1422b97cc2e2da42b5aa3</Guid><Name>{6da638fd-4014-4f6a-907d-9c72b6cb4a00}</Name><RegisteredItem>Event Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9783eb36d0c7422b8c171d80d0d543fc</Guid><Name>{4dbe0a15-c08b-43cb-b3f5-d7faf06013d9}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>cfbe1030212b478b9bf1abb26a6c176c</Guid><Name>{e2b5a776-61cb-48bd-9d36-e6d56f063a9e}</Name><Status>Executed</Status><RegisteredItem>Default Client Event Wizard</RegisteredItem></WizardDefinition><Guid>d4d60b830e4747aa9a003efce91af7b1</Guid><Name>保补一级主管审批</Name><EventItemGuid>ee127334-0c9b-4f3f-ac1b-b13ce9affba3</EventItemGuid><SucceedingRuleGuid>078000f1-797c-4467-9b3e-4cfecf9aa4c8</SucceedingRuleGuid><Type>Client</Type></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>85730cdfbc0d41fe97edfba76974103e</Guid><Name>{5ff4294e-d121-4432-9ba2-03f061d5d469}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>48460eb71fbd47d487d508aaed1cb67e</Guid><Name>{48b9caae-d2a5-4780-99b2-2ae5403bd9ca}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9646ef20af8842d2a2af9e51d075568f</Guid><Name>{f6a964f6-92ea-428c-9589-a10d6a43dba1}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>11483232c6164da1bc194b70ba14ed1b</Guid><Name>{c8aa95b0-a3d9-40fd-b0d5-2a7432f18486}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem><RunAdvancedMode>1</RunAdvancedMode></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f5dda04976b64c3c911bdcd201c8f30f</Guid><Name>{c928ff17-f72f-4e46-9f61-a3dbb224f657}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>47342959a7844327a47513b0f1d45bef</Guid><Name>{eac822ea-90d5-4420-a42a-c9b32fc485f8}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomeSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ab1859d6e7634eacaaee31019ff0e6ae</Guid><Name>{0d37741f-215f-48c9-8cd1-cc1b5d9698cb}</Name><RegisteredItem>C76701EE-F9D5-40f8-AD2B-0E954A21DF3D</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>45e7e6a0afb34da585df407f8f15529c</Guid><Name>{aee5f988-f953-4c2e-b8d4-d86b277eb4d0}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>6a5dbb7078634e908fa3d2189c04c3ab</Guid><Name>保补一级主管</Name><Slots>1</Slots><Type>DestinationInstanceParralel</Type><DestinationRuleGuid>a07a3365-082d-4398-a8e3-080ce8584e75</DestinationRuleGuid><PrecedingRuleGuid>9367e97c-26f3-4abc-a61f-d7bed6e6e9b8</PrecedingRuleGuid><StartRuleGuid>90ea7db1-954b-4ac4-9180-f221660e9a99</StartRuleGuid><SucceedingRuleGuid>4c027f2d-b26c-4a46-bf20-14e817c5f7cb</SucceedingRuleGuid></Activity><Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><DataFields><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>a759680704894127920134dfced95c53</Guid><Name>ActionURL</Name><Audit>0</Audit><Type>String</Type><Scope>Activity</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>6091ded11ca741648811f57ad66685b2</Guid><Name>Action Result</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Destination</Scope><Category>Outcomes</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>26c63ae44fc64d27945f7900fe463a64</Guid><Name>Outcome</Name><Hidden>1</Hidden><OnDemand>0</OnDemand><Type>String</Type><Scope>Activity</Scope><Category>Outcomes</Category></DataField></DataFields><Events><Event Type="SourceCode.Workflow.Design.ClientEvent" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Actions><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>42eb04983cc84736bd1076b8a1d196ca</Guid><Name>同意</Name><ActionItemGuid>83b08964-451f-40ea-b971-6bc1e58a9ad8</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction><EventAction Type="SourceCode.Workflow.Authoring.EventAction" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3a107f5119674a219ce191384ea84472</Guid><Name>拒绝</Name><ActionItemGuid>d45a54b9-4c8c-4e16-b390-bb44983b1301</ActionItemGuid><BatchProcessed>1</BatchProcessed></EventAction></Actions><WizardDefinition Type="SourceCode.Workflow.Design.DefaultClientWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>462ea1d9d62044d6b18900bcd59e1a92</Guid><Name>{d008df43-0c2c-4a8e-8dc4-8440d88f0169}</Name><RegisteredItem>Event General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.DefaultClientPropertyWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>7e1ae1da0a9d4b398f784b20c22f398a</Guid><Name>{544ccaa2-e1b2-4a60-8390-4d39de8df3af}</Name><RegisteredItem>Client Event Item Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c0b632c52f0f4bb488e2706b80634d0a</Guid><Name>{06e09673-86dc-4096-8c7c-77e3b704b8e4}</Name><RegisteredItem>Event Actions and Outcome Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>74019f1327d14cbc88be1de1e0476d0d</Guid><Name>{ed4cf74a-8b31-4c27-a550-bd9c2e8b6f94}</Name><RegisteredItem>Event Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>55a6c12b67e24c5fbf0f2fead6e8a7b0</Guid><Name>{91f53364-97e5-426f-bd4c-1ef3a31419c6}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>ce6c92aeacbc4ac784c962556a99dce4</Guid><Name>{1ed8eb6d-fa48-4ec9-8fd1-3ab2244db257}</Name><Status>Executed</Status><RegisteredItem>Default Client Event Wizard</RegisteredItem></WizardDefinition><Guid>ec151a1ae26b49cdab230e7a962a4bf1</Guid><Name>地区经理审批</Name><EventItemGuid>e58f5458-d460-4040-99fa-e7b6128227d0</EventItemGuid><SucceedingRuleGuid>ecba67ab-a87f-4e5d-8fe3-92ea591f29d1</SucceedingRuleGuid><Type>Client</Type></Event></Events><WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0a95c1d671f34c29a65a4a82c927b322</Guid><Name>{4039b148-22e4-42f8-b4db-90e007d17369}</Name><RegisteredItem>Activity General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9b7c7c08f46b47c2bcf023909840b825</Guid><Name>{e9902f03-989a-40d4-b1f5-58338f8c2818}</Name><RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>75b529e66e1d4826a9743edcf609edbc</Guid><Name>{385fe5fc-f88b-4416-b796-2cf473fb200b}</Name><RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b6a3e46bd12c4e7aa25ad47279c16258</Guid><Name>{2b88705e-aecd-4efa-bde5-e833be94337c}</Name><RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem><RunAdvancedMode>1</RunAdvancedMode></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f142a38fcf534609af03bbb8f65fbb75</Guid><Name>{3dc80697-0606-4e99-97a9-e014927661ec}</Name><RegisteredItem>Activity Escalations</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ecae484891a14cb58bc1cde1349f2fd5</Guid><Name>{15c5ca48-b3c5-4b33-8b6b-b03d9e6c5138}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Outcome.OutcomeSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>381a9cf3d89c4372a50cff425cf717c9</Guid><Name>{87669fe5-3cdb-417d-9d71-0418a3eb8153}</Name><RegisteredItem>C76701EE-F9D5-40f8-AD2B-0E954A21DF3D</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>25bd5c5116c34c1585ff8dd0a1326ad3</Guid><Name>{1b55d8e6-6e65-449d-b423-2ad5d3b7f8b9}</Name><Status>Executed</Status><RegisteredItem>Default Activity Wizard</RegisteredItem></WizardDefinition><Guid>bd952f2d0fd748dc9261ae9deb80abce</Guid><Name>地区经理</Name><Slots>1</Slots><Type>DestinationInstanceParralel</Type><DestinationRuleGuid>3fd014c6-ad5f-48c4-a6fd-9f363dc69333</DestinationRuleGuid><PrecedingRuleGuid>0d409e17-c0fb-4720-9295-0954fe29f3d9</PrecedingRuleGuid><StartRuleGuid>62b71f94-20a0-428b-97ce-0aa5bdbff63a</StartRuleGuid><SucceedingRuleGuid>1577fce3-84cb-4a24-a87a-592c3bbbe674</SucceedingRuleGuid></Activity></Activities><StartActivity><Guid>00b998f2916a47caa8d2fb2e73cab141</Guid><Name>Start</Name><Type>SingleInstance</Type></StartActivity><DataFields><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3c27ae45792c457493f31ae9dcfe347e</Guid><Name>ProcessCode</Name><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5f1dc9b6100f470cabe475e59af89500</Guid><Name>WFState</Name><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ac786bbcadcf4a7b9dbdb4ca38ebccea</Guid><Name>ViewInstURL</Name><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3e6c96bdb08247ca9b2243e64bbe933d</Guid><Name>dest_Creator</Name><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>7f0621a52cef466687c18346755b2437</Guid><Name>dest_salesmanager</Name><Description>地区经理








</Description><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>937da70b961749c2a520d128fcb7f6c8</Guid><Name>dest_allowancemanagerlevel1</Name><Description>保补一级主管






</Description><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b86946fdccec4d7d9fbdf702be00c7e1</Guid><Name>dest_allowancer</Name><Description>保补审批员



</Description><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField><DataField Type="SourceCode.Workflow.Authoring.DataField" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c9c6cded20cb40df83340a117c31a7dd</Guid><Name>dest_citymanager</Name><Description>城市经理
</Description><Audit>0</Audit><OnDemand>0</OnDemand><Type>String</Type><Scope>Process</Scope><Log>0</Log><Category>None</Category><Value /></DataField></DataFields><Views><ProcessView Type="SourceCode.Workflow.Design.ProcessView" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><ActivitiesLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1e391be264b74ffc89cbf22afe8bd270</Guid><Width>190</Width><Height>40</Height><X>200</X><Y>10</Y><Name>{00b998f2-916a-47ca-a8d2-fb2e73cab141}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>30596548fb884896bbbbee8a40c19ede</Guid><Name>{3731415a-97fe-45ee-ba38-58bc84dd234f}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>dd979b254064400fb2b896861ca3fafb</Guid><Width>190</Width><Height>71</Height><X>192</X><Y>112</Y><Name>{5d4e06c0-b05b-49f3-b4c3-ff6f298e0f64}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsActivityStripOpen>1</IsActivityStripOpen><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>565877f2abae4cf5a1f36c8c9a271f94</Guid><Name>{1c0fd53a-7e2c-4ee3-9a3c-2e73c2484ee0}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>744fdc75e28948b2b154c2487d962418</Guid><Width>190</Width><Height>48</Height><X>464</X><Y>128</Y><Name>{43cde613-cb03-4d1a-91ae-5075924cd4e4}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>343f2992e24a4299b529f5532888f9b6</Guid><Name>{f7d1af2e-2a65-4c9d-834f-f6c9ae167d30}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>dbc6cde6991143d08b56eeb692806717</Guid><Width>190</Width><Height>48</Height><X>464</X><Y>256</Y><Name>{f154d5f6-b4e2-4e54-a80c-9f558d0457f4}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>5772187ef342457cbb144bb6f74e28b0</Guid><Name>{969129ce-b917-417a-a3a5-c6984df62cf7}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>cab6c02989c9499699ee39096923c647</Guid><Width>190</Width><Height>48</Height><X>464</X><Y>16</Y><Name>{a86b3c69-97ae-4cae-bc6f-ddb9c1287aab}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><FontColorR>0</FontColorR><FontColorG>0</FontColorG><FontColorB>0</FontColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f967dff16ea34cb2b700563b44672ad5</Guid><Name>{9a1cc623-0a71-4150-8bfc-9af0d225f6c9}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>96f5f14d4f0e4050a4d4d464567fd114</Guid><Width>190</Width><Height>71</Height><X>192</X><Y>256</Y><Name>{ba7c0334-6c7d-4419-ba00-9b2c31cd0435}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><FontColorR>0</FontColorR><FontColorG>0</FontColorG><FontColorB>0</FontColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsActivityStripOpen>1</IsActivityStripOpen><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b7c8140921564c89b950b5d5a5533c7e</Guid><Name>{d476475a-68ca-4786-8ea7-660dfba7e1d7}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>965889dcaa8242758557514ff53eeffe</Guid><Width>190</Width><Height>48</Height><X>192</X><Y>880</Y><Name>{4607d319-99e9-4211-ae48-a66248cfe1dd}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><FontColorR>0</FontColorR><FontColorG>0</FontColorG><FontColorB>0</FontColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>fceb578a97fc4be9825a17c5abee2605</Guid><Name>{44c1278e-212c-4f83-be86-1b3ea0eea6ae}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>38fb3997077144a6acf33365946473dc</Guid><Width>190</Width><Height>71</Height><X>192</X><Y>560</Y><Name>{1cea4bea-345b-4cc0-98d0-441da2427b85}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsActivityStripOpen>1</IsActivityStripOpen><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0685b482a6014e60bdd84f705b94116f</Guid><Name>{d4d60b83-0e47-47aa-9a00-3efce91af7b1}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>2df2dbefbb874e228db4159280928b1e</Guid><Width>190</Width><Height>71</Height><X>192</X><Y>720</Y><Name>{6a5dbb70-7863-4e90-8fa3-d2189c04c3ab}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><FontColorR>0</FontColorR><FontColorG>0</FontColorG><FontColorB>0</FontColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsActivityStripOpen>1</IsActivityStripOpen><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData><ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><EventsLayoutData><ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1cb594c89ef7403eb8382c3c57b45c67</Guid><Name>{ec151a1a-e26b-49cd-ab23-0e7a962a4bf1}</Name></ProcessViewEventLayoutData></EventsLayoutData><Guid>56219ad26d084c7b935affff2394aef3</Guid><Width>190</Width><Height>71</Height><X>192</X><Y>416</Y><Name>{bd952f2d-0fd7-48dc-9261-ae9deb80abce}</Name><MainColorR>166</MainColorR><MainColorG>166</MainColorG><MainColorB>166</MainColorB><ButtonsColorR>1</ButtonsColorR><ButtonsColorG>97</ButtonsColorG><ButtonsColorB>154</ButtonsColorB><SelectionColorR>0</SelectionColorR><SelectionColorG>0</SelectionColorG><SelectionColorB>0</SelectionColorB><IsActivityStripOpen>1</IsActivityStripOpen><IsEventStripOpen>1</IsEventStripOpen><IsMinimizedLabelVisible>1</IsMinimizedLabelVisible></ProcessViewActivityLayoutData></ActivitiesLayoutData><LinesLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>280fb0e51c104f65af3e25cd4c893e96</Guid><StartMaximizedX>102</StartMaximizedX><StartMaximizedY>48</StartMaximizedY><StartMinimizedX>112</StartMinimizedX><StartMinimizedY>40</StartMinimizedY><EndMaximizedX>112</EndMaximizedX><EndMaximizedY>-10</EndMaximizedY><EndMinimizedX>65</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>0</LabelDragged><LabelLocationX>309</LabelLocationX><LabelLocationY>65</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>302</LineRenderPointX_0><LineRenderPointY_0>51</LineRenderPointY_0><LineRenderPointX_1>302</LineRenderPointX_1><LineRenderPointY_1>69</LineRenderPointY_1><LineRenderPointX_2>302</LineRenderPointX_2><LineRenderPointY_2>80</LineRenderPointY_2><LineRenderPointX_3>302</LineRenderPointX_3><LineRenderPointY_3>92</LineRenderPointY_3><LineRenderPointX_4>302</LineRenderPointX_4><LineRenderPointY_4>102</LineRenderPointY_4><Name>{fed11d46-e9d0-422e-ba50-4be782c32c3a}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>8e4c0a4d822b41e0adf4976cfb6f76ab</Guid><StartDirectionMaximized>Left</StartDirectionMaximized><StartMaximizedX>-10</StartMaximizedX><StartMaximizedY>16</StartMaximizedY><StartMinimizedX>20</StartMinimizedX><StartMinimizedY>40</StartMinimizedY><EndDirectionMaximized>Right</EndDirectionMaximized><EndMaximizedX>199</EndMaximizedX><EndMaximizedY>48</EndMaximizedY><EndMinimizedX>95</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><Label>重新提交</Label><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>1</LabelDragged><LabelLocationX>407</LabelLocationX><LabelLocationY>156</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>462</LineRenderPointX_0><LineRenderPointY_0>144</LineRenderPointY_0><LineRenderPointX_1>444</LineRenderPointX_1><LineRenderPointY_1>144</LineRenderPointY_1><LineRenderPointX_2>422</LineRenderPointX_2><LineRenderPointY_2>144</LineRenderPointY_2><LineRenderPointX_3>401</LineRenderPointX_3><LineRenderPointY_3>144</LineRenderPointY_3><LineRenderPointX_4>391</LineRenderPointX_4><LineRenderPointY_4>144</LineRenderPointY_4><Name>{54bb9fda-2584-41b2-9e72-9563d14de5ee}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>9df3b184d8d945c39cb3f8409a155c1e</Guid><StartMaximizedX>120</StartMaximizedX><StartMaximizedY>81</StartMaximizedY><StartMinimizedX>120</StartMinimizedX><StartMinimizedY>40</StartMinimizedY><EndMaximizedX>112</EndMaximizedX><EndMaximizedY>-10</EndMaximizedY><EndMinimizedX>95</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><Label>结束流程</Label><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>1</LabelDragged><LabelLocationX>566</LabelLocationX><LabelLocationY>213</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>584</LineRenderPointX_0><LineRenderPointY_0>199</LineRenderPointY_0><LineRenderPointX_1>584</LineRenderPointX_1><LineRenderPointY_1>217</LineRenderPointY_1><LineRenderPointX_2>584</LineRenderPointX_2><LineRenderPointY_2>226</LineRenderPointY_2><LineRenderPointX_3>584</LineRenderPointX_3><LineRenderPointY_3>236</LineRenderPointY_3><LineRenderPointX_4>584</LineRenderPointX_4><LineRenderPointY_4>246</LineRenderPointY_4><Name>{2ce76362-3a13-4907-93ce-cc703db886b5}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>aee56f6e95e34952a70e7d011387ecd2</Guid><StartMaximizedX>96</StartMaximizedX><StartMaximizedY>102</StartMaximizedY><StartMinimizedX>99</StartMinimizedX><StartMinimizedY>95</StartMinimizedY><EndMaximizedX>96</EndMaximizedX><EndMaximizedY>-10</EndMaximizedY><EndMinimizedX>100</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>0</LabelDragged><LabelLocationX>285</LabelLocationX><LabelLocationY>220</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>288</LineRenderPointX_0><LineRenderPointY_0>206</LineRenderPointY_0><LineRenderPointX_1>288</LineRenderPointX_1><LineRenderPointY_1>224</LineRenderPointY_1><LineRenderPointX_2>288</LineRenderPointX_2><LineRenderPointY_2>230</LineRenderPointY_2><LineRenderPointX_3>288</LineRenderPointX_3><LineRenderPointY_3>236</LineRenderPointY_3><LineRenderPointX_4>288</LineRenderPointX_4><LineRenderPointY_4>246</LineRenderPointY_4><Name>{82026e7e-7b79-40a6-81e4-8d24e229f6cb}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>14ca3bf2d0a2472b99bae68aecb9ef5b</Guid><StartDirectionMaximized>Right</StartDirectionMaximized><StartMaximizedX>199</StartMaximizedX><StartMaximizedY>27</StartMaximizedY><StartMinimizedX>190</StartMinimizedX><StartMinimizedY>26</StartMinimizedY><EndDirectionMaximized>Left</EndDirectionMaximized><EndMaximizedX>-10</EndMaximizedX><EndMaximizedY>32</EndMaximizedY><EndMinimizedX>44</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>0</LabelDragged><LabelLocationX>429</LabelLocationX><LabelLocationY>65</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>391</LineRenderPointX_0><LineRenderPointY_0>37</LineRenderPointY_0><LineRenderPointX_1>409</LineRenderPointX_1><LineRenderPointY_1>37</LineRenderPointY_1><LineRenderPointX_2>426</LineRenderPointX_2><LineRenderPointY_2>37</LineRenderPointY_2><LineRenderPointX_3>444</LineRenderPointX_3><LineRenderPointY_3>37</LineRenderPointY_3><LineRenderPointX_4>454</LineRenderPointX_4><LineRenderPointY_4>37</LineRenderPointY_4><Name>{d0281720-42f9-40de-8366-62eb363d01ba}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>86d3a4a06ef54a0f95509dc29a27b6c7</Guid><StartMaximizedX>98</StartMaximizedX><StartMaximizedY>80</StartMaximizedY><StartMinimizedX>66</StartMinimizedX><StartMinimizedY>72</StartMinimizedY><EndMaximizedX>118</EndMaximizedX><EndMaximizedY>0</EndMaximizedY><EndMinimizedX>118</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>0</LabelDragged><LabelLocationX>677</LabelLocationX><LabelLocationY>123</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>562</LineRenderPointX_0><LineRenderPointY_0>87</LineRenderPointY_0><LineRenderPointX_1>562</LineRenderPointX_1><LineRenderPointY_1>105</LineRenderPointY_1><LineRenderPointX_2>562</LineRenderPointX_2><LineRenderPointY_2>106</LineRenderPointY_2><LineRenderPointX_3>562</LineRenderPointX_3><LineRenderPointY_3>108</LineRenderPointY_3><LineRenderPointX_4>562</LineRenderPointX_4><LineRenderPointY_4>118</LineRenderPointY_4><Name>{f3617d95-7f21-4ca4-9ad0-94d04db35ef0}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>7687be1e07364dd392bd8a2640286b3a</Guid><StartMaximizedX>96</StartMaximizedX><StartMaximizedY>102</StartMaximizedY><StartMinimizedX>95</StartMinimizedX><StartMinimizedY>40</StartMinimizedY><EndMaximizedX>96</EndMaximizedX><EndMaximizedY>-10</EndMaximizedY><EndMinimizedX>95</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><Label>同意</Label><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>1</LabelDragged><LabelLocationX>297</LabelLocationX><LabelLocationY>426</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>288</LineRenderPointX_0><LineRenderPointY_0>350</LineRenderPointY_0><LineRenderPointX_1>288</LineRenderPointX_1><LineRenderPointY_1>368</LineRenderPointY_1><LineRenderPointX_2>288</LineRenderPointX_2><LineRenderPointY_2>382</LineRenderPointY_2><LineRenderPointX_3>288</LineRenderPointX_3><LineRenderPointY_3>396</LineRenderPointY_3><LineRenderPointX_4>288</LineRenderPointX_4><LineRenderPointY_4>406</LineRenderPointY_4><Name>{91335fd8-cab2-49a0-9426-d2efe1cf51cb}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>ba6659d3e6ec4d678602f8ffd77dde6d</Guid><StartMaximizedX>96</StartMaximizedX><StartMaximizedY>104</StartMaximizedY><StartMinimizedX>95</StartMinimizedX><StartMinimizedY>40</StartMinimizedY><EndMaximizedX>96</EndMaximizedX><EndMaximizedY>-10</EndMaximizedY><EndMinimizedX>95</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><Label>同意</Label><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>0</LabelDragged><LabelLocationX>269</LabelLocationX><LabelLocationY>670</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>288</LineRenderPointX_0><LineRenderPointY_0>654</LineRenderPointY_0><LineRenderPointX_1>288</LineRenderPointX_1><LineRenderPointY_1>672</LineRenderPointY_1><LineRenderPointX_2>288</LineRenderPointX_2><LineRenderPointY_2>686</LineRenderPointY_2><LineRenderPointX_3>288</LineRenderPointX_3><LineRenderPointY_3>700</LineRenderPointY_3><LineRenderPointX_4>288</LineRenderPointX_4><LineRenderPointY_4>710</LineRenderPointY_4><Name>{9fed9f02-ae74-4de7-8d68-b0e6464c25ee}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>eedd227bd6f949529f1feff9148add90</Guid><StartMaximizedX>96</StartMaximizedX><StartMaximizedY>104</StartMaximizedY><StartMinimizedX>95</StartMinimizedX><StartMinimizedY>40</StartMinimizedY><EndMaximizedX>96</EndMaximizedX><EndMaximizedY>-10</EndMaximizedY><EndMinimizedX>95</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><Label>同意</Label><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>0</LabelDragged><LabelLocationX>269</LabelLocationX><LabelLocationY>830</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>288</LineRenderPointX_0><LineRenderPointY_0>814</LineRenderPointY_0><LineRenderPointX_1>288</LineRenderPointX_1><LineRenderPointY_1>832</LineRenderPointY_1><LineRenderPointX_2>288</LineRenderPointX_2><LineRenderPointY_2>846</LineRenderPointY_2><LineRenderPointX_3>288</LineRenderPointX_3><LineRenderPointY_3>860</LineRenderPointY_3><LineRenderPointX_4>288</LineRenderPointX_4><LineRenderPointY_4>870</LineRenderPointY_4><Name>{d7b82295-800a-4ef1-a608-fa63a9808893}</Name></ProcessViewLineLayoutData><ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bfc9028e19ce4777a92f8eb1391b61f3</Guid><StartMaximizedX>96</StartMaximizedX><StartMaximizedY>104</StartMaximizedY><StartMinimizedX>95</StartMinimizedX><StartMinimizedY>40</StartMinimizedY><EndMaximizedX>96</EndMaximizedX><EndMaximizedY>-10</EndMaximizedY><EndMinimizedX>95</EndMinimizedX><EndMinimizedY>0</EndMinimizedY><Label>同意</Label><LabelLocked>0</LabelLocked><LabelVisible>1</LabelVisible><LabelDragged>0</LabelDragged><LabelLocationX>285</LabelLocationX><LabelLocationY>526</LabelLocationY><LineColorR>26</LineColorR><LineColorG>85</LineColorG><LineColorB>39</LineColorB><LineSelectionColorR>0</LineSelectionColorR><LineSelectionColorG>0</LineSelectionColorG><LineSelectionColorB>0</LineSelectionColorB><LinePinned>0</LinePinned><LineRenderPointCount>5</LineRenderPointCount><LineRenderPointX_0>288</LineRenderPointX_0><LineRenderPointY_0>510</LineRenderPointY_0><LineRenderPointX_1>288</LineRenderPointX_1><LineRenderPointY_1>528</LineRenderPointY_1><LineRenderPointX_2>288</LineRenderPointX_2><LineRenderPointY_2>534</LineRenderPointY_2><LineRenderPointX_3>288</LineRenderPointX_3><LineRenderPointY_3>540</LineRenderPointY_3><LineRenderPointX_4>288</LineRenderPointX_4><LineRenderPointY_4>550</LineRenderPointY_4><Name>{88174aef-83d0-456b-ba13-6d4932cb4288}</Name></ProcessViewLineLayoutData></LinesLayoutData><Guid>efd5728763d8472abaa5fbefa3afac32</Guid><Name>ProcessView</Name><GridSizeWidth>16</GridSizeWidth><GridSizeHeight>16</GridSizeHeight></ProcessView><DocumentView Type="SourceCode.Workflow.Design.DocumentView" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c3a1e93efba943b4a6f06d213ccacc5f</Guid><Name>DocumentView</Name><ActivitiesHeading>Activities</ActivitiesHeading><ActivitiesHeadingFontData>Arial,12,Bold,None</ActivitiesHeadingFontData><ActivitiesDescription>Activities Section Description</ActivitiesDescription><ActivitiesDescriptionFontData>Arial,12,Bold,None</ActivitiesDescriptionFontData><LinesHeading>Lines</LinesHeading><LinesHeadingFontData>Arial,12,Bold,None</LinesHeadingFontData><LinesDescription>Arial,12,Bold,None</LinesDescription><DataFieldsAreaHeading>Data Fields</DataFieldsAreaHeading><DataFieldsAreaHeadingFontData>Arial,12,Bold,None</DataFieldsAreaHeadingFontData><DataFieldsAreaDescription>Data Fields Section Description</DataFieldsAreaDescription><DataFieldsAreaDescriptionFontData>Arial,12,Bold,None</DataFieldsAreaDescriptionFontData><XMLFieldsAreaHeading>XML Fields</XMLFieldsAreaHeading><XMLFieldsAreaHeadingFontData>Arial,12,Bold,None</XMLFieldsAreaHeadingFontData><XMLFieldsAreaDescription>XML Fields Section Description</XMLFieldsAreaDescription><XMLFieldsAreaDescriptionFontData>Arial,12,Bold,None</XMLFieldsAreaDescriptionFontData></DocumentView></Views><WizardDefinition Type="SourceCode.Workflow.Design.DefaultWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><PropertyWizardDefinitions><PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c26df850b182413d8bc5fc03b74df4b0</Guid><Name>{61e3ec00-1ba9-43bd-a3c4-1f226db33cfb}</Name><RegisteredItem>Process General Property Wizard</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d7c10ced19e34a93b160bc61d92f0a4f</Guid><Name>{10b62754-f79b-4c58-bcc2-470e6f8337a8}</Name><RegisteredItem>Process Escalations</RegisteredItem><AdvancedMode>1</AdvancedMode></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>823acf9338454aa6b3f9d978bcf8b90b</Guid><Name>{33cf8c2d-460a-4dd5-a0a9-d3489394ec60}</Name><RegisteredItem>Exception Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.ProcessStartRule.DefaultProcessStartRuleWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>c5f317dcdd9f4598a82dbeb4e81ff270</Guid><Name>{ce335a40-3806-4cd1-9efc-7a983aaeb63d}</Name><RegisteredItem>Process Start Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.ProcessFinishRule.DefaultProcessFinishRuleWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>2b5cb3a44d0e4f51b7097db0fd4687fe</Guid><Name>{04a3330a-f60b-4c42-9103-b6c2e558c921}</Name><RegisteredItem>Process Finish Rule</RegisteredItem></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.Associations.AssociationsPropertyDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><WorkflowSmartObjectsCreation Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectCreation" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>65cdd60192514aeb9bbc505cb850a6d4</Guid></WorkflowSmartObjectsCreation><ReportingSmartObjectsCreation Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectCreation" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>27bc5df6d1aa4a47849dd207b678702f</Guid></ReportingSmartObjectsCreation><SmartObjectServicesDesignerMappings><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>292a361a08404e42b1808cfdc2e57bd5</Guid><DesignerGuid>d58b0010-9236-483f-b121-a209cab60148</DesignerGuid><WorkflowSmartObjectGuid>17eee3d3-b2ee-4768-8490-baaacd7a644e</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>a971a2ea-b6ec-4281-9b0c-e2957ab2bf84</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0c679f3e84cc4bdcad72cd9b01f1871b</Guid><DesignerGuid>00b998f2-916a-47ca-a8d2-fb2e73cab141</DesignerGuid><WorkflowSmartObjectGuid>b00bb65c-e23e-4b9a-b16c-8fef411bc691</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>5733b396-7dc2-4c09-93cc-b1371139cf02</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>223d196aac29415d89d04e2836395a83</Guid><DesignerGuid>5d4e06c0-b05b-49f3-b4c3-ff6f298e0f64</DesignerGuid><WorkflowSmartObjectGuid>57bd9f23-9adf-49a5-9db1-c1001d1c770c</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>22c9374b-b474-47e1-89fe-10179e4522c1</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>de8cc4e81af840629c17e1523a619ed1</Guid><DesignerGuid>3731415a-97fe-45ee-ba38-58bc84dd234f</DesignerGuid><WorkflowSmartObjectGuid>5478f13c-4e12-4851-8a57-874a66da30cd</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>18a9f98b-c76c-417a-818d-df115b7d7765</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>faf4ff1981d84c9984e456bcf94bed24</Guid><DesignerGuid>43cde613-cb03-4d1a-91ae-5075924cd4e4</DesignerGuid><WorkflowSmartObjectGuid>271353a8-3eb8-45e7-a2e6-bdfbd50e934d</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>61fd40a5-76ca-4da9-b5e4-3abb6d060a5e</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>f5b4835474f048d5bd02b6fa451a6a01</Guid><DesignerGuid>1c0fd53a-7e2c-4ee3-9a3c-2e73c2484ee0</DesignerGuid><WorkflowSmartObjectGuid>04a934b0-d0ca-462b-96ac-9a5cde70e636</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>d3e2fc23-c535-4380-a048-4759ea44da3d</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3be80bb32f284fb699aac29c19843fb8</Guid><DesignerGuid>f154d5f6-b4e2-4e54-a80c-9f558d0457f4</DesignerGuid><WorkflowSmartObjectGuid>3a8d1369-3b68-4b43-a101-cd97f860c652</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>dff42223-afb0-442c-84a6-b2b6b47b0961</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>e0887bd70dc343928040a0a7d6ca7e78</Guid><DesignerGuid>f7d1af2e-2a65-4c9d-834f-f6c9ae167d30</DesignerGuid><WorkflowSmartObjectGuid>c9e0ed0e-740d-4bce-9b15-15d3f8e15490</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>8e9aa4c3-44e5-4e8b-b3ca-980075ee7fe4</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>69152049684e496687adee6c99e55b7c</Guid><DesignerGuid>a86b3c69-97ae-4cae-bc6f-ddb9c1287aab</DesignerGuid><WorkflowSmartObjectGuid>a3bdb3ca-1262-4d7a-a62f-6f0dc83b9448</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>d6384106-e44f-4183-bec0-bb99abfb65e6</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>0303cd034c25491a884e867ab4849872</Guid><DesignerGuid>969129ce-b917-417a-a3a5-c6984df62cf7</DesignerGuid><WorkflowSmartObjectGuid>85a67131-747b-4db5-8b9d-4635fc4a76c1</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>590f4b3d-2db1-4533-8255-f1da8a05c1c1</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>3ecd536fe8984d86a3195abf41f2a6c0</Guid><DesignerGuid>ba7c0334-6c7d-4419-ba00-9b2c31cd0435</DesignerGuid><WorkflowSmartObjectGuid>d076d32a-5cc6-41e4-81f6-d3d967af9c74</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>7719b33c-5b51-4189-8673-05e34911956a</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>d200bb0117534b398cba7ac682d6f5d5</Guid><DesignerGuid>9a1cc623-0a71-4150-8bfc-9af0d225f6c9</DesignerGuid><WorkflowSmartObjectGuid>0b6f7509-668c-4b8b-b592-e79e1f13de20</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>80702dc0-4297-4365-a951-3b524714625e</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>152917f2541d487093398c444bdc6bde</Guid><DesignerGuid>4607d319-99e9-4211-ae48-a66248cfe1dd</DesignerGuid><WorkflowSmartObjectGuid>a96d8e6b-2b31-45be-badf-7f875904d212</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>1e8b2ecb-fde0-4b5d-9224-100745ee5fb5</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>67ac697bce5c4500a03ee0f5f714a409</Guid><DesignerGuid>d476475a-68ca-4786-8ea7-660dfba7e1d7</DesignerGuid><WorkflowSmartObjectGuid>5a95572d-2b9e-4824-85a2-e231b22ee5cc</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>7898dcb5-0f47-4c24-976d-0af577f91ad4</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>7171af17883f474994b1407576cd7730</Guid><DesignerGuid>1cea4bea-345b-4cc0-98d0-441da2427b85</DesignerGuid><WorkflowSmartObjectGuid>8cf8d882-aacb-4b64-a3f3-4545361c7a3d</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>50a51310-e008-47f0-afce-116b15a459f4</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>1257d4e3e0e9470b94b1738f79ade982</Guid><DesignerGuid>44c1278e-212c-4f83-be86-1b3ea0eea6ae</DesignerGuid><WorkflowSmartObjectGuid>c071de2d-7ad9-46d6-b3ee-1e0783b68214</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>718f6c1e-ac64-4b1f-93de-4a8674b16cfe</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>e6c2c6edd8b84b72b3bfb26c58a11b10</Guid><DesignerGuid>6a5dbb70-7863-4e90-8fa3-d2189c04c3ab</DesignerGuid><WorkflowSmartObjectGuid>15efc55b-78b9-4d20-955c-95bb3e71da10</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>4ca57d77-29a5-4973-b7ab-8faf791a13d2</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>bce94fc6d8be42eb8fdb27705a2ba311</Guid><DesignerGuid>d4d60b83-0e47-47aa-9a00-3efce91af7b1</DesignerGuid><WorkflowSmartObjectGuid>1ff69143-b2cc-4a2d-aa39-9340f15982b4</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>e81eddf5-82fd-4c7b-94b1-c694acea71f4</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>b887b91723df487dbed7cfa6cb034ade</Guid><DesignerGuid>bd952f2d-0fd7-48dc-9261-ae9deb80abce</DesignerGuid><WorkflowSmartObjectGuid>86663c66-0145-46ed-8950-52db18c4adfe</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>c8fd6a02-d76d-460a-8bd1-1487a08336c5</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping><SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>07d936f0e4344005ae6b9d9cd43d920e</Guid><DesignerGuid>ec151a1a-e26b-49cd-ab23-0e7a962a4bf1</DesignerGuid><WorkflowSmartObjectGuid>3f711c2b-d360-4226-b615-14580ddce6de</WorkflowSmartObjectGuid><WorkflowReportingSmartObjectGuid>674b39eb-f351-4e8f-be27-d36244f74ca7</WorkflowReportingSmartObjectGuid></SmartObjectServicesDesignerMapping></SmartObjectServicesDesignerMappings><Guid>a5bb7e250290473b8619c3634723bf24</Guid><Name>{b4e9af93-0597-4a77-bfc3-e3ecfb5edea5}</Name><RegisteredItem>2124FC5B-E0CF-49D9-8331-DF2B47F2A93E</RegisteredItem><UseSmartObjectServicesDesignerMapping>0</UseSmartObjectServicesDesignerMapping></PropertyWizardDefinition><PropertyWizardDefinition Type="SourceCode.Workflow.Design.References.ProjectReferencesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d"><Guid>808adf108e46421fb4d252d0020cfdb3</Guid><Name>{65d4a052-ca64-4184-9f15-aa5693bdb935}</Name><RegisteredItem>FDA04D27-504A-4D24-A5BC-854E8CF395E0</RegisteredItem></PropertyWizardDefinition></PropertyWizardDefinitions><Guid>05eefb5814a644f5a8ccab774f5fe115</Guid><Name /><Status>Executed</Status><RegisteredItem>Default Process Wizard</RegisteredItem></WizardDefinition><Guid>d58b00109236483fb121a209cab60148</Guid><Name>保补审批流程</Name><ExtenderNamespace>fe8a038ea9ab4e2ab327ec5be381164a</ExtenderNamespace><OriginalPath>保补审批流程.kprx</OriginalPath><DefaultExecutionLayer>Default</DefaultExecutionLayer><CurrentExecutionLayer>Default</CurrentExecutionLayer><CurrentView>ProcessView</CurrentView></Process>